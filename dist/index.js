import{DataTypes as e,Sequelize as t}from"sequelize";import r from"mongoose";import n from"crypto";import s,{Buffer as o}from"buffer";import i,{Duplex as a,Writable as c,PassThrough as u}from"stream";import l from"util";import f from"node-forge";import{Readable as h}from"node:stream";import"http";import"https";import"http2";import*as d from"zlib";import p,{homedir as m}from"os";import g,{sep as y,join as E}from"path";import b,{promises as w}from"fs";class v{static instance=null;constructor(e,t){if(v.instance)return console.log("üîÑ Returning existing DBService instance..."),v.instance;if(!e)throw new Error("dbInstance is required");this.dbInstance=e,this.lookuptable=t?.lookuptable||this.dbInstance.lookuptable,this.dbtype="",this.User=null,this.sequelize=null,this.initError=null,this.initPromise=this.initDatabase().then((()=>console.log("‚úÖ Database initialized successfully"))).catch((e=>{console.error("‚ùå Database initialization failed:",e),this.initError=e})),v.instance=this}async initDatabase(){try{if(!this.lookuptable)throw new Error("lookuptable is required for database initialization");if(this.dbInstance?.connection?.client)console.log("‚úÖ Connected to MongoDB"),this.dbtype="mongo",this.User=(n=this.lookuptable,r.models[n]?r.model(n):r.model(n,new r.Schema({},{strict:!1}),n));else{if(!this.dbInstance?.config)throw new Error("Unsupported database type");if(console.log("‚úÖ Connected to SQL Database:"),this.dbtype="sql",!this.dbInstance.dialect)throw Error("Dialect is required");this.sequelize=new t(this.dbInstance?.config.database,this.dbInstance?.config?.username||this.dbInstance?.config?.user,this.dbInstance?.config?.password,{host:this.dbInstance?.config?.host,dialect:this.dbInstance.dialect,logging:!1}),await this.sequelize.authenticate(),console.log("‚úÖ Sequelize authenticated successfully"),this.User=((t,r)=>{const n=t.define("User",{id:{type:e.INTEGER,autoIncrement:!0,primaryKey:!0,allowNull:!1},email:{type:e.STRING,allowNull:!1,unique:!0,validate:{isEmail:!0}},password:{type:e.STRING,allowNull:!1},username:{type:e.STRING,allowNull:!0}},{timestamps:!0,tableName:r,freezeTableName:!0,createdAt:"createdat",updatedAt:"updatedat"});return n.sync({alter:!0}).then((()=>{console.log(`‚úÖ Table "${r}" is ready.`)})).catch((e=>{console.error(`‚ùå Error syncing "${r}" table:`,e)})),n})(this.sequelize,this.lookuptable)}}catch(e){throw new Error(`Database Error - ${e.message}`)}var n}static getInstance(e,t){return v.instance||(v.instance=new v(e,t)),v.instance}}var S=null;function N(e,t){if("number"!=typeof(e=e||_))throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var r=[];return r.push("$2b$"),e<10&&r.push("0"),r.push(e.toString()),r.push("$"),r.push(P(function(e){try{return crypto.getRandomValues(new Uint8Array(e))}catch{}try{return n.randomBytes(e)}catch{}if(!S)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return S(e)}(L),L)),r.join("")}function I(e,t,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof e&&(r=e,e=void 0),void 0===e)e=_;else if("number"!=typeof e)throw Error("illegal arguments: "+typeof e);function n(t){C((function(){try{t(null,N(e))}catch(e){t(e)}}))}if(!r)return new Promise((function(e,t){n((function(r,n){r?t(r):e(n)}))}));if("function"!=typeof r)throw Error("Illegal callback: "+typeof r);n(r)}function x(e,t){if(void 0===t&&(t=_),"number"==typeof t&&(t=N(t)),"string"!=typeof e||"string"!=typeof t)throw Error("Illegal arguments: "+typeof e+", "+typeof t);return q(e,t)}function A(e,t,r,n){function s(r){"string"==typeof e&&"number"==typeof t?I(t,(function(t,s){q(e,s,r,n)})):"string"==typeof e&&"string"==typeof t?q(e,t,r,n):C(r.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)))}if(!r)return new Promise((function(e,t){s((function(r,n){r?t(r):e(n)}))}));if("function"!=typeof r)throw Error("Illegal callback: "+typeof r);s(r)}function $(e,t){for(var r=e.length^t.length,n=0;n<e.length;++n)r|=e.charCodeAt(n)^t.charCodeAt(n);return 0===r}var C="undefined"!=typeof process&&process&&"function"==typeof process.nextTick?"function"==typeof setImmediate?setImmediate:process.nextTick:setTimeout;function T(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t}var O="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),R=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function P(e,t){var r,n,s=0,o=[];if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;s<t;){if(r=255&e[s++],o.push(O[r>>2&63]),r=(3&r)<<4,s>=t){o.push(O[63&r]);break}if(r|=(n=255&e[s++])>>4&15,o.push(O[63&r]),r=(15&n)<<2,s>=t){o.push(O[63&r]);break}r|=(n=255&e[s++])>>6&3,o.push(O[63&r]),o.push(O[63&n])}return o.join("")}function k(e,t){var r,n,s,o,i,a=0,c=e.length,u=0,l=[];if(t<=0)throw Error("Illegal len: "+t);for(;a<c-1&&u<t&&(r=(i=e.charCodeAt(a++))<R.length?R[i]:-1,n=(i=e.charCodeAt(a++))<R.length?R[i]:-1,-1!=r&&-1!=n)&&(o=r<<2>>>0,o|=(48&n)>>4,l.push(String.fromCharCode(o)),!(++u>=t||a>=c))&&-1!=(s=(i=e.charCodeAt(a++))<R.length?R[i]:-1)&&(o=(15&n)<<4>>>0,o|=(60&s)>>2,l.push(String.fromCharCode(o)),!(++u>=t||a>=c));)o=(3&s)<<6>>>0,o|=(i=e.charCodeAt(a++))<R.length?R[i]:-1,l.push(String.fromCharCode(o)),++u;var f=[];for(a=0;a<u;a++)f.push(l[a].charCodeAt(0));return f}var L=16,_=10,j=16,M=100,D=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],U=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],B=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function F(e,t,r,n){var s,o=e[t],i=e[t+1];return s=n[(o^=r[0])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(i^=(s+=n[768|255&o])^r[1])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(o^=(s+=n[768|255&i])^r[2])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(i^=(s+=n[768|255&o])^r[3])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(o^=(s+=n[768|255&i])^r[4])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(i^=(s+=n[768|255&o])^r[5])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(o^=(s+=n[768|255&i])^r[6])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(i^=(s+=n[768|255&o])^r[7])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(o^=(s+=n[768|255&i])^r[8])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(i^=(s+=n[768|255&o])^r[9])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(o^=(s+=n[768|255&i])^r[10])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(i^=(s+=n[768|255&o])^r[11])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(o^=(s+=n[768|255&i])^r[12])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(i^=(s+=n[768|255&o])^r[13])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s=n[(o^=(s+=n[768|255&i])^r[14])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(i^=(s+=n[768|255&o])^r[15])>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],o^=(s+=n[768|255&i])^r[16],e[t]=i^r[j+1],e[t+1]=o,e}function V(e,t){for(var r=0,n=0;r<4;++r)n=n<<8|255&e[t],t=(t+1)%e.length;return{key:n,offp:t}}function z(e,t,r){for(var n,s=0,o=[0,0],i=t.length,a=r.length,c=0;c<i;c++)s=(n=V(e,s)).offp,t[c]=t[c]^n.key;for(c=0;c<i;c+=2)o=F(o,0,t,r),t[c]=o[0],t[c+1]=o[1];for(c=0;c<a;c+=2)o=F(o,0,t,r),r[c]=o[0],r[c+1]=o[1]}function K(e,t,r,n,s){var o,i=B.slice(),a=i.length;if(r<4||r>31){if(o=Error("Illegal number of rounds (4-31): "+r),n)return void C(n.bind(this,o));throw o}if(t.length!==L){if(o=Error("Illegal salt length: "+t.length+" != "+L),n)return void C(n.bind(this,o));throw o}r=1<<r>>>0;var c,u,l,f=0;function h(){if(s&&s(f/r),!(f<r)){for(f=0;f<64;f++)for(l=0;l<a>>1;l++)F(i,l<<1,c,u);var o=[];for(f=0;f<a;f++)o.push((i[f]>>24&255)>>>0),o.push((i[f]>>16&255)>>>0),o.push((i[f]>>8&255)>>>0),o.push((255&i[f])>>>0);return n?void n(null,o):o}for(var d=Date.now();f<r&&(f+=1,z(e,c,u),z(t,c,u),!(Date.now()-d>M)););n&&C(h)}if("function"==typeof Int32Array?(c=new Int32Array(D),u=new Int32Array(U)):(c=D.slice(),u=U.slice()),function(e,t,r,n){for(var s,o=0,i=[0,0],a=r.length,c=n.length,u=0;u<a;u++)o=(s=V(t,o)).offp,r[u]=r[u]^s.key;for(o=0,u=0;u<a;u+=2)o=(s=V(e,o)).offp,i[0]^=s.key,o=(s=V(e,o)).offp,i[1]^=s.key,i=F(i,0,r,n),r[u]=i[0],r[u+1]=i[1];for(u=0;u<c;u+=2)o=(s=V(e,o)).offp,i[0]^=s.key,o=(s=V(e,o)).offp,i[1]^=s.key,i=F(i,0,r,n),n[u]=i[0],n[u+1]=i[1]}(t,e,c,u),void 0!==n)h();else for(var d;;)if(void 0!==(d=h()))return d||[]}function q(e,t,r,n){var s,o,i;if("string"!=typeof e||"string"!=typeof t){if(s=Error("Invalid string / salt: Not a string"),r)return void C(r.bind(this,s));throw s}if("$"!==t.charAt(0)||"2"!==t.charAt(1)){if(s=Error("Invalid salt version: "+t.substring(0,2)),r)return void C(r.bind(this,s));throw s}if("$"===t.charAt(2))o=String.fromCharCode(0),i=3;else{if("a"!==(o=t.charAt(2))&&"b"!==o&&"y"!==o||"$"!==t.charAt(3)){if(s=Error("Invalid salt revision: "+t.substring(2,4)),r)return void C(r.bind(this,s));throw s}i=4}if(t.charAt(i+2)>"$"){if(s=Error("Missing salt rounds"),r)return void C(r.bind(this,s));throw s}var a=10*parseInt(t.substring(i,i+1),10)+parseInt(t.substring(i+1,i+2),10),c=t.substring(i+3,i+25),u=function(e){for(var t,r,n=0,s=new Array(T(e)),o=0,i=e.length;o<i;++o)(t=e.charCodeAt(o))<128?s[n++]=t:t<2048?(s[n++]=t>>6|192,s[n++]=63&t|128):55296==(64512&t)&&56320==(64512&(r=e.charCodeAt(o+1)))?(t=65536+((1023&t)<<10)+(1023&r),++o,s[n++]=t>>18|240,s[n++]=t>>12&63|128,s[n++]=t>>6&63|128,s[n++]=63&t|128):(s[n++]=t>>12|224,s[n++]=t>>6&63|128,s[n++]=63&t|128);return s}(e+=o>="a"?"\0":""),l=k(c,L);function f(e){var t=[];return t.push("$2"),o>="a"&&t.push(o),t.push("$"),a<10&&t.push("0"),t.push(a.toString()),t.push("$"),t.push(P(l,l.length)),t.push(P(e,4*B.length-1)),t.join("")}if(void 0===r)return f(K(u,l,a));K(u,l,a,(function(e,t){e?r(e,null):r(null,f(t))}),n)}var H={setRandomFallback:function(e){S=e},genSaltSync:N,genSalt:I,hashSync:x,hash:A,compareSync:function(e,t){if("string"!=typeof e||"string"!=typeof t)throw Error("Illegal arguments: "+typeof e+", "+typeof t);return 60===t.length&&$(x(e,t.substring(0,t.length-31)),t)},compare:function(e,t,r,n){function s(r){"string"==typeof e&&"string"==typeof t?60===t.length?A(e,t.substring(0,29),(function(e,n){e?r(e):r(null,$(n,t))}),n):C(r.bind(this,null,!1)):C(r.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)))}if(!r)return new Promise((function(e,t){s((function(r,n){r?t(r):e(n)}))}));if("function"!=typeof r)throw Error("Illegal callback: "+typeof r);s(r)},getRounds:function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)},getSalt:function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);if(60!==e.length)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)},truncates:function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);return T(e)>72},encodeBase64:function(e,t){return P(e,t)},decodeBase64:function(e,t){return k(e,t)}};function G(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var W,X,Y,J,Z,Q,ee,te,re,ne,se,oe,ie,ae,ce,ue,le,fe,he,de,pe,me,ge,ye,Ee,be,we,ve,Se,Ne,Ie={},xe={exports:{}};function Ae(){return W||(W=1,function(e,t){var r=s,n=r.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function i(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=i),i.prototype=Object.create(n.prototype),o(n,i),i.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},i.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var s=n(e);return void 0!==t?"string"==typeof r?s.fill(t,r):s.fill(t):s.fill(0),s},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(xe,xe.exports)),xe.exports}function $e(){if(Y)return X;Y=1;var e=Ae().Buffer,t=i;function r(t){if(this.buffer=null,this.writable=!0,this.readable=!0,!t)return this.buffer=e.alloc(0),this;if("function"==typeof t.pipe)return this.buffer=e.alloc(0),t.pipe(this),this;if(t.length||"object"==typeof t)return this.buffer=t,this.writable=!1,process.nextTick(function(){this.emit("end",t),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof t+")")}return l.inherits(r,t),r.prototype.write=function(t){this.buffer=e.concat([this.buffer,e.from(t)]),this.emit("data",t)},r.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},X=r}function Ce(){if(re)return te;re=1;var e=Ae().Buffer,t=function(){if(ee)return Q;function e(e){return(e/8|0)+(e%8==0?0:1)}ee=1;var t={ES256:e(256),ES384:e(384),ES512:e(521)};return Q=function(e){var r=t[e];if(r)return r;throw new Error('Unknown algorithm "'+e+'"')}}(),r=128;function n(t){if(e.isBuffer(t))return t;if("string"==typeof t)return e.from(t,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function s(e,t,n){for(var s=0;t+s<n&&0===e[t+s];)++s;return e[t+s]>=r&&--s,s}return te={derToJose:function(r,s){r=n(r);var o=t(s),i=o+1,a=r.length,c=0;if(48!==r[c++])throw new Error('Could not find expected "seq"');var u=r[c++];if(129===u&&(u=r[c++]),a-c<u)throw new Error('"seq" specified length of "'+u+'", only "'+(a-c)+'" remaining');if(2!==r[c++])throw new Error('Could not find expected "int" for "r"');var l=r[c++];if(a-c-2<l)throw new Error('"r" specified length of "'+l+'", only "'+(a-c-2)+'" available');if(i<l)throw new Error('"r" specified length of "'+l+'", max of "'+i+'" is acceptable');var f=c;if(c+=l,2!==r[c++])throw new Error('Could not find expected "int" for "s"');var h=r[c++];if(a-c!==h)throw new Error('"s" specified length of "'+h+'", expected "'+(a-c)+'"');if(i<h)throw new Error('"s" specified length of "'+h+'", max of "'+i+'" is acceptable');var d=c;if((c+=h)!==a)throw new Error('Expected to consume entire buffer, but "'+(a-c)+'" bytes remain');var p=o-l,m=o-h,g=e.allocUnsafe(p+l+m+h);for(c=0;c<p;++c)g[c]=0;r.copy(g,c,f+Math.max(-p,0),f+l);for(var y=c=o;c<y+m;++c)g[c]=0;return r.copy(g,c,d+Math.max(-m,0),d+h),g=(g=g.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(o,i){o=n(o);var a=t(i),c=o.length;if(c!==2*a)throw new TypeError('"'+i+'" signatures must be "'+2*a+'" bytes, saw "'+c+'"');var u=s(o,0,a),l=s(o,a,o.length),f=a-u,h=a-l,d=2+f+1+1+h,p=d<r,m=e.allocUnsafe((p?2:3)+d),g=0;return m[g++]=48,p?m[g++]=d:(m[g++]=129,m[g++]=255&d),m[g++]=2,m[g++]=f,u<0?(m[g++]=0,g+=o.copy(m,g,0,a)):g+=o.copy(m,g,u,a),m[g++]=2,m[g++]=h,l<0?(m[g++]=0,o.copy(m,g,a)):o.copy(m,g,a+l),m}}}function Te(){if(se)return ne;se=1;var e=function(){if(Z)return J;Z=1;var e=s.Buffer,t=s.SlowBuffer;function r(t,r){if(!e.isBuffer(t)||!e.isBuffer(r))return!1;if(t.length!==r.length)return!1;for(var n=0,s=0;s<t.length;s++)n|=t[s]^r[s];return 0===n}J=r,r.install=function(){e.prototype.equal=t.prototype.equal=function(e){return r(this,e)}};var n=e.prototype.equal,o=t.prototype.equal;return r.restore=function(){e.prototype.equal=n,t.prototype.equal=o},J}(),t=Ae().Buffer,r=n,o=Ce(),i=l,a="secret must be a string or buffer",c="key must be a string or a buffer",u="function"==typeof r.createPublicKey;function f(e){if(!t.isBuffer(e)&&"string"!=typeof e){if(!u)throw m(c);if("object"!=typeof e)throw m(c);if("string"!=typeof e.type)throw m(c);if("string"!=typeof e.asymmetricKeyType)throw m(c);if("function"!=typeof e.export)throw m(c)}}function h(e){if(!t.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw m("key must be a string, a buffer or an object")}function d(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function p(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function m(e){var t=[].slice.call(arguments,1),r=i.format.bind(i,e).apply(null,t);return new TypeError(r)}function g(e){var r;return r=e,t.isBuffer(r)||"string"==typeof r||(e=JSON.stringify(e)),e}function y(e){return function(n,s){!function(e){if(!t.isBuffer(e)){if("string"==typeof e)return e;if(!u)throw m(a);if("object"!=typeof e)throw m(a);if("secret"!==e.type)throw m(a);if("function"!=typeof e.export)throw m(a)}}(s),n=g(n);var o=r.createHmac("sha"+e,s);return d((o.update(n),o.digest("base64")))}}function E(r){return function(n,s,o){var i=y(r)(n,o);return e(t.from(s),t.from(i))}}function b(e){return function(t,n){h(n),t=g(t);var s=r.createSign("RSA-SHA"+e);return d((s.update(t),s.sign(n,"base64")))}}function w(e){return function(t,n,s){f(s),t=g(t),n=p(n);var o=r.createVerify("RSA-SHA"+e);return o.update(t),o.verify(s,n,"base64")}}function v(e){return function(t,n){h(n),t=g(t);var s=r.createSign("RSA-SHA"+e);return d((s.update(t),s.sign({key:n,padding:r.constants.RSA_PKCS1_PSS_PADDING,saltLength:r.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function S(e){return function(t,n,s){f(s),t=g(t),n=p(n);var o=r.createVerify("RSA-SHA"+e);return o.update(t),o.verify({key:s,padding:r.constants.RSA_PKCS1_PSS_PADDING,saltLength:r.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function N(e){var t=b(e);return function(){var r=t.apply(null,arguments);return r=o.derToJose(r,"ES"+e)}}function I(e){var t=w(e);return function(r,n,s){return n=o.joseToDer(n,"ES"+e).toString("base64"),t(r,n,s)}}function x(){return function(){return""}}function A(){return function(e,t){return""===t}}return u&&(c+=" or a KeyObject",a+="or a KeyObject"),ne=function(e){var t={hs:y,rs:b,ps:v,es:N,none:x},r={hs:E,rs:w,ps:S,es:I,none:A},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw m('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var s=(n[1]||n[3]).toLowerCase(),o=n[2];return{sign:t[s](o),verify:r[s](o)}}}function Oe(){if(ie)return oe;ie=1;var e=s.Buffer;return oe=function(t){return"string"==typeof t?t:"number"==typeof t||e.isBuffer(t)?t.toString():JSON.stringify(t)}}function Re(){if(ce)return ae;ce=1;var e=Ae().Buffer,t=$e(),r=Te(),n=i,s=Oe(),o=l;function a(t,r){return e.from(t,r).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function c(e){var t=e.header,n=e.payload,i=e.secret||e.privateKey,c=e.encoding,u=r(t.alg),l=function(e,t,r){r=r||"utf8";var n=a(s(e),"binary"),i=a(s(t),r);return o.format("%s.%s",n,i)}(t,n,c),f=u.sign(l,i);return o.format("%s.%s",l,f)}function u(e){var r=e.secret||e.privateKey||e.key,n=new t(r);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=n,this.payload=new t(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}return o.inherits(u,n),u.prototype.sign=function(){try{var e=c({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},u.sign=c,ae=u}function Pe(){if(le)return ue;le=1;var e=Ae().Buffer,t=$e(),r=Te(),n=i,s=Oe(),o=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function a(e){if(function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e))return e;try{return JSON.parse(e)}catch(e){return}}function c(t){var r=t.split(".",1)[0];return a(e.from(r,"base64").toString("binary"))}function u(e){return e.split(".")[2]}function f(e){return o.test(e)&&!!c(e)}function h(e,t,n){if(!t){var o=new Error("Missing algorithm parameter for jws.verify");throw o.code="MISSING_ALGORITHM",o}var i=u(e=s(e)),a=function(e){return e.split(".",2).join(".")}(e);return r(t).verify(a,i,n)}function d(t,r){if(r=r||{},!f(t=s(t)))return null;var n=c(t);if(!n)return null;var o=function(t,r){r=r||"utf8";var n=t.split(".")[1];return e.from(n,"base64").toString(r)}(t);return("JWT"===n.typ||r.json)&&(o=JSON.parse(o,r.encoding)),{header:n,payload:o,signature:u(t)}}function p(e){var r=(e=e||{}).secret||e.publicKey||e.key,n=new t(r);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=n,this.signature=new t(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}return l.inherits(p,n),p.prototype.verify=function(){try{var e=h(this.signature.buffer,this.algorithm,this.key.buffer),t=d(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},p.decode=d,p.isValid=f,p.verify=h,ue=p}function ke(){if(fe)return Ie;fe=1;var e=Re(),t=Pe();return Ie.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],Ie.sign=e.sign,Ie.verify=t.verify,Ie.decode=t.decode,Ie.isValid=t.isValid,Ie.createSign=function(t){return new e(t)},Ie.createVerify=function(e){return new t(e)},Ie}function Le(){if(de)return he;de=1;var e=ke();return he=function(t,r){r=r||{};var n=e.decode(t,r);if(!n)return null;var s=n.payload;if("string"==typeof s)try{var o=JSON.parse(s);null!==o&&"object"==typeof o&&(s=o)}catch(e){}return!0===r.complete?{header:n.header,payload:s,signature:n.signature}:s},he}function _e(){if(me)return pe;me=1;var e=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,t&&(this.inner=t)};return(e.prototype=Object.create(Error.prototype)).constructor=e,pe=e}function je(){if(ye)return ge;ye=1;var e=_e(),t=function(t,r){e.call(this,t),this.name="NotBeforeError",this.date=r};return(t.prototype=Object.create(e.prototype)).constructor=t,ge=t}function Me(){if(be)return Ee;be=1;var e=_e(),t=function(t,r){e.call(this,t),this.name="TokenExpiredError",this.expiredAt=r};return(t.prototype=Object.create(e.prototype)).constructor=t,Ee=t}function De(){if(ve)return we;ve=1;var e=1e3,t=60*e,r=60*t,n=24*r,s=7*n,o=365.25*n;function i(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}return we=function(a,c){c=c||{};var u=typeof a;if("string"===u&&a.length>0)return function(i){if((i=String(i)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*n;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*t;case"seconds":case"second":case"secs":case"sec":case"s":return c*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(a);if("number"===u&&isFinite(a))return c.long?function(s){var o=Math.abs(s);if(o>=n)return i(s,o,n,"day");if(o>=r)return i(s,o,r,"hour");if(o>=t)return i(s,o,t,"minute");if(o>=e)return i(s,o,e,"second");return s+" ms"}(a):function(s){var o=Math.abs(s);if(o>=n)return Math.round(s/n)+"d";if(o>=r)return Math.round(s/r)+"h";if(o>=t)return Math.round(s/t)+"m";if(o>=e)return Math.round(s/e)+"s";return s+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}}function Ue(){if(Ne)return Se;Ne=1;var e=De();return Se=function(t,r){var n=r||Math.floor(Date.now()/1e3);if("string"==typeof t){var s=e(t);if(void 0===s)return;return Math.floor(n+s/1e3)}return"number"==typeof t?n+t:void 0}}var Be,Fe,Ve,ze,Ke,qe,He,Ge,We,Xe,Ye,Je,Ze,Qe,et,tt,rt,nt,st,ot,it,at,ct,ut,lt,ft,ht,dt,pt,mt,gt,yt,Et,bt,wt,vt,St,Nt,It,xt,At,$t,Ct,Tt,Ot,Rt,Pt,kt,Lt,_t,jt,Mt,Dt,Ut,Bt,Ft,Vt,zt,Kt,qt,Ht,Gt,Wt,Xt,Yt,Jt,Zt,Qt,er,tr,rr,nr,sr,or,ir,ar,cr,ur,lr,fr,hr,dr,pr,mr,gr,yr,Er,br,wr,vr,Sr,Nr,Ir,xr,Ar,$r,Cr,Tr,Or,Rr,Pr,kr,Lr,_r,jr,Mr,Dr,Ur,Br,Fr,Vr,zr,Kr,qr,Hr,Gr,Wr,Xr={exports:{}};function Yr(){if(Fe)return Be;Fe=1;const e=Number.MAX_SAFE_INTEGER||9007199254740991;return Be={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:e,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}}function Jr(){if(ze)return Ve;ze=1;const e="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};return Ve=e}function Zr(){return Ke||(Ke=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:s}=Yr(),o=Jr(),i=(t=e.exports={}).re=[],a=t.safeRe=[],c=t.src=[],u=t.safeSrc=[],l=t.t={};let f=0;const h="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",s],[h,n]],p=(e,t,r)=>{const n=(e=>{for(const[t,r]of d)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),s=f++;o(e,s,t),l[e]=s,c[s]=t,u[s]=n,i[s]=new RegExp(t,r?"g":void 0),a[s]=new RegExp(n,r?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),p("MAINVERSION",`(${c[l.NUMERICIDENTIFIER]})\\.(${c[l.NUMERICIDENTIFIER]})\\.(${c[l.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${c[l.NUMERICIDENTIFIERLOOSE]})\\.(${c[l.NUMERICIDENTIFIERLOOSE]})\\.(${c[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${c[l.NUMERICIDENTIFIER]}|${c[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${c[l.NUMERICIDENTIFIERLOOSE]}|${c[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${c[l.PRERELEASEIDENTIFIER]}(?:\\.${c[l.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${c[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[l.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${h}+`),p("BUILD",`(?:\\+(${c[l.BUILDIDENTIFIER]}(?:\\.${c[l.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${c[l.MAINVERSION]}${c[l.PRERELEASE]}?${c[l.BUILD]}?`),p("FULL",`^${c[l.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${c[l.MAINVERSIONLOOSE]}${c[l.PRERELEASELOOSE]}?${c[l.BUILD]}?`),p("LOOSE",`^${c[l.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${c[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${c[l.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${c[l.XRANGEIDENTIFIER]})(?:\\.(${c[l.XRANGEIDENTIFIER]})(?:\\.(${c[l.XRANGEIDENTIFIER]})(?:${c[l.PRERELEASE]})?${c[l.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${c[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[l.XRANGEIDENTIFIERLOOSE]})(?:${c[l.PRERELEASELOOSE]})?${c[l.BUILD]}?)?)?`),p("XRANGE",`^${c[l.GTLT]}\\s*${c[l.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${c[l.GTLT]}\\s*${c[l.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),p("COERCE",`${c[l.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",c[l.COERCEPLAIN]+`(?:${c[l.PRERELEASE]})?`+`(?:${c[l.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",c[l.COERCE],!0),p("COERCERTLFULL",c[l.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${c[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${c[l.LONETILDE]}${c[l.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${c[l.LONETILDE]}${c[l.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${c[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${c[l.LONECARET]}${c[l.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${c[l.LONECARET]}${c[l.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${c[l.GTLT]}\\s*(${c[l.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${c[l.GTLT]}\\s*(${c[l.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${c[l.GTLT]}\\s*(${c[l.LOOSEPLAIN]}|${c[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${c[l.XRANGEPLAIN]})\\s+-\\s+(${c[l.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${c[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[l.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Xr,Xr.exports)),Xr.exports}function Qr(){if(He)return qe;He=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return qe=r=>r?"object"!=typeof r?e:r:t}function en(){if(We)return Ge;We=1;const e=/^[0-9]+$/,t=(t,r)=>{const n=e.test(t),s=e.test(r);return n&&s&&(t=+t,r=+r),t===r?0:n&&!s?-1:s&&!n?1:t<r?-1:1};return Ge={compareIdentifiers:t,rcompareIdentifiers:(e,r)=>t(r,e)}}function tn(){if(Ye)return Xe;Ye=1;const e=Jr(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:r}=Yr(),{safeRe:n,safeSrc:s,t:o}=Zr(),i=Qr(),{compareIdentifiers:a}=en();class c{constructor(s,a){if(a=i(a),s instanceof c){if(s.loose===!!a.loose&&s.includePrerelease===!!a.includePrerelease)return s;s=s.version}else if("string"!=typeof s)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof s}".`);if(s.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",s,a),this.options=a,this.loose=!!a.loose,this.includePrerelease=!!a.includePrerelease;const u=s.trim().match(a.loose?n[o.LOOSE]:n[o.FULL]);if(!u)throw new TypeError(`Invalid Version: ${s}`);if(this.raw=s,this.major=+u[1],this.minor=+u[2],this.patch=+u[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");u[4]?this.prerelease=u[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=u[5]?u[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(e("SemVer.compare",this.version,this.options,t),!(t instanceof c)){if("string"==typeof t&&t===this.version)return 0;t=new c(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),a(this.major,e.major)||a(this.minor,e.minor)||a(this.patch,e.patch)}comparePre(t){if(t instanceof c||(t=new c(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{const n=this.prerelease[r],s=t.prerelease[r];if(e("prerelease compare",r,n,s),void 0===n&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===n)return-1;if(n!==s)return a(n,s)}while(++r)}compareBuild(t){t instanceof c||(t=new c(t,this.options));let r=0;do{const n=this.build[r],s=t.build[r];if(e("build compare",r,n,s),void 0===n&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===n)return-1;if(n!==s)return a(n,s)}while(++r)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(t){const e=new RegExp(`^${this.options.loose?s[o.PRERELEASELOOSE]:s[o.PRERELEASE]}$`),r=`-${t}`.match(e);if(!r||r[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let n=[t,e];!1===r&&(n=[t]),0===a(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Xe=c}function rn(){if(Ze)return Je;Ze=1;const e=tn();return Je=(t,r,n=!1)=>{if(t instanceof e)return t;try{return new e(t,r)}catch(e){if(!n)return null;throw e}},Je}function nn(){if(gt)return mt;gt=1;const e=tn();return mt=(t,r,n)=>new e(t,n).compare(new e(r,n))}function sn(){if(St)return vt;St=1;const e=tn();return vt=(t,r,n)=>{const s=new e(t,n),o=new e(r,n);return s.compare(o)||s.compareBuild(o)}}function on(){if(Ct)return $t;Ct=1;const e=nn();return $t=(t,r,n)=>e(t,r,n)>0}function an(){if(Ot)return Tt;Ot=1;const e=nn();return Tt=(t,r,n)=>e(t,r,n)<0}function cn(){if(Pt)return Rt;Pt=1;const e=nn();return Rt=(t,r,n)=>0===e(t,r,n)}function un(){if(Lt)return kt;Lt=1;const e=nn();return kt=(t,r,n)=>0!==e(t,r,n)}function ln(){if(jt)return _t;jt=1;const e=nn();return _t=(t,r,n)=>e(t,r,n)>=0}function fn(){if(Dt)return Mt;Dt=1;const e=nn();return Mt=(t,r,n)=>e(t,r,n)<=0}function hn(){if(Bt)return Ut;Bt=1;const e=cn(),t=un(),r=on(),n=ln(),s=an(),o=fn();return Ut=(i,a,c,u)=>{switch(a){case"===":return"object"==typeof i&&(i=i.version),"object"==typeof c&&(c=c.version),i===c;case"!==":return"object"==typeof i&&(i=i.version),"object"==typeof c&&(c=c.version),i!==c;case"":case"=":case"==":return e(i,c,u);case"!=":return t(i,c,u);case">":return r(i,c,u);case">=":return n(i,c,u);case"<":return s(i,c,u);case"<=":return o(i,c,u);default:throw new TypeError(`Invalid operator: ${a}`)}}}function dn(){if(Ht)return qt;Ht=1;const e=/\s+/g;class t{constructor(r,o){if(o=n(o),r instanceof t)return r.loose===!!o.loose&&r.includePrerelease===!!o.includePrerelease?r:new t(r.raw,o);if(r instanceof s)return this.raw=r.value,this.set=[[r]],this.formatted=void 0,this;if(this.options=o,this.loose=!!o.loose,this.includePrerelease=!!o.includePrerelease,this.raw=r.trim().replace(e," "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!p(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&m(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&h)|(this.options.loose&&d))+":"+e,n=r.get(t);if(n)return n;const i=this.options.loose,m=i?a[c.HYPHENRANGELOOSE]:a[c.HYPHENRANGE];e=e.replace(m,$(this.options.includePrerelease)),o("hyphen replace",e),e=e.replace(a[c.COMPARATORTRIM],u),o("comparator trim",e),e=e.replace(a[c.TILDETRIM],l),o("tilde trim",e),e=e.replace(a[c.CARETTRIM],f),o("caret trim",e);let g=e.split(" ").map((e=>y(e,this.options))).join(" ").split(/\s+/).map((e=>A(e,this.options)));i&&(g=g.filter((e=>(o("loose invalid filter",e,this.options),!!e.match(a[c.COMPARATORLOOSE]))))),o("range list",g);const E=new Map,b=g.map((e=>new s(e,this.options)));for(const e of b){if(p(e))return[e];E.set(e.value,e)}E.size>1&&E.has("")&&E.delete("");const w=[...E.values()];return r.set(t,w),w}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some((t=>g(t,r)&&e.set.some((e=>g(e,r)&&t.every((t=>e.every((e=>t.intersects(e,r)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new i(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(C(this.set[t],e,this.options))return!0;return!1}}qt=t;const r=new(Kt?zt:(Kt=1,zt=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}})),n=Qr(),s=pn(),o=Jr(),i=tn(),{safeRe:a,t:c,comparatorTrimReplace:u,tildeTrimReplace:l,caretTrimReplace:f}=Zr(),{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:d}=Yr(),p=e=>"<0.0.0-0"===e.value,m=e=>""===e.value,g=(e,t)=>{let r=!0;const n=e.slice();let s=n.pop();for(;r&&n.length;)r=n.every((e=>s.intersects(e,t))),s=n.pop();return r},y=(e,t)=>(o("comp",e,t),e=v(e,t),o("caret",e),e=b(e,t),o("tildes",e),e=N(e,t),o("xrange",e),e=x(e,t),o("stars",e),e),E=e=>!e||"x"===e.toLowerCase()||"*"===e,b=(e,t)=>e.trim().split(/\s+/).map((e=>w(e,t))).join(" "),w=(e,t)=>{const r=t.loose?a[c.TILDELOOSE]:a[c.TILDE];return e.replace(r,((t,r,n,s,i)=>{let a;return o("tilde",e,t,r,n,s,i),E(r)?a="":E(n)?a=`>=${r}.0.0 <${+r+1}.0.0-0`:E(s)?a=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:i?(o("replaceTilde pr",i),a=`>=${r}.${n}.${s}-${i} <${r}.${+n+1}.0-0`):a=`>=${r}.${n}.${s} <${r}.${+n+1}.0-0`,o("tilde return",a),a}))},v=(e,t)=>e.trim().split(/\s+/).map((e=>S(e,t))).join(" "),S=(e,t)=>{o("caret",e,t);const r=t.loose?a[c.CARETLOOSE]:a[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,((t,r,s,i,a)=>{let c;return o("caret",e,t,r,s,i,a),E(r)?c="":E(s)?c=`>=${r}.0.0${n} <${+r+1}.0.0-0`:E(i)?c="0"===r?`>=${r}.${s}.0${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.0${n} <${+r+1}.0.0-0`:a?(o("replaceCaret pr",a),c="0"===r?"0"===s?`>=${r}.${s}.${i}-${a} <${r}.${s}.${+i+1}-0`:`>=${r}.${s}.${i}-${a} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${i}-${a} <${+r+1}.0.0-0`):(o("no pr"),c="0"===r?"0"===s?`>=${r}.${s}.${i}${n} <${r}.${s}.${+i+1}-0`:`>=${r}.${s}.${i}${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${i} <${+r+1}.0.0-0`),o("caret return",c),c}))},N=(e,t)=>(o("replaceXRanges",e,t),e.split(/\s+/).map((e=>I(e,t))).join(" ")),I=(e,t)=>{e=e.trim();const r=t.loose?a[c.XRANGELOOSE]:a[c.XRANGE];return e.replace(r,((r,n,s,i,a,c)=>{o("xRange",e,r,n,s,i,a,c);const u=E(s),l=u||E(i),f=l||E(a),h=f;return"="===n&&h&&(n=""),c=t.includePrerelease?"-0":"",u?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&h?(l&&(i=0),a=0,">"===n?(n=">=",l?(s=+s+1,i=0,a=0):(i=+i+1,a=0)):"<="===n&&(n="<",l?s=+s+1:i=+i+1),"<"===n&&(c="-0"),r=`${n+s}.${i}.${a}${c}`):l?r=`>=${s}.0.0${c} <${+s+1}.0.0-0`:f&&(r=`>=${s}.${i}.0${c} <${s}.${+i+1}.0-0`),o("xRange return",r),r}))},x=(e,t)=>(o("replaceStars",e,t),e.trim().replace(a[c.STAR],"")),A=(e,t)=>(o("replaceGTE0",e,t),e.trim().replace(a[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),$=e=>(t,r,n,s,o,i,a,c,u,l,f,h)=>`${r=E(n)?"":E(s)?`>=${n}.0.0${e?"-0":""}`:E(o)?`>=${n}.${s}.0${e?"-0":""}`:i?`>=${r}`:`>=${r}${e?"-0":""}`} ${c=E(u)?"":E(l)?`<${+u+1}.0.0-0`:E(f)?`<${u}.${+l+1}.0-0`:h?`<=${u}.${l}.${f}-${h}`:e?`<${u}.${l}.${+f+1}-0`:`<=${c}`}`.trim(),C=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(o(e[r].semver),e[r].semver!==s.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0};return qt}function pn(){if(Wt)return Gt;Wt=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(n,s){if(s=r(s),n instanceof t){if(n.loose===!!s.loose)return n;n=n.value}n=n.trim().split(/\s+/).join(" "),i("comparator",n,s),this.options=s,this.loose=!!s.loose,this.parse(n),this.semver===e?this.value="":this.value=this.operator+this.semver.version,i("comp",this)}parse(t){const r=this.options.loose?n[s.COMPARATORLOOSE]:n[s.COMPARATOR],o=t.match(r);if(!o)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==o[1]?o[1]:"","="===this.operator&&(this.operator=""),o[2]?this.semver=new a(o[2],this.options.loose):this.semver=e}toString(){return this.value}test(t){if(i("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new a(t,this.options)}catch(e){return!1}return o(t,this.operator,this.semver,this.options)}intersects(e,n){if(!(e instanceof t))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new c(e.value,n).test(this.value):""===e.operator?""===e.value||new c(this.value,n).test(e.semver):(!(n=r(n)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&(!(!n.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!e.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!e.operator.startsWith("<"))||(!(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))||(!!(o(this.semver,"<",e.semver,n)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))||!!(o(this.semver,">",e.semver,n)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))))))}}Gt=t;const r=Qr(),{safeRe:n,t:s}=Zr(),o=hn(),i=Jr(),a=tn(),c=dn();return Gt}function mn(){if(Yt)return Xt;Yt=1;const e=dn();return Xt=(t,r,n)=>{try{r=new e(r,n)}catch(e){return!1}return r.test(t)},Xt}function gn(){if(ir)return or;ir=1;const e=dn();return or=(t,r)=>{try{return new e(t,r).range||"*"}catch(e){return null}},or}function yn(){if(cr)return ar;cr=1;const e=tn(),t=pn(),{ANY:r}=t,n=dn(),s=mn(),o=on(),i=an(),a=fn(),c=ln();return ar=(u,l,f,h)=>{let d,p,m,g,y;switch(u=new e(u,h),l=new n(l,h),f){case">":d=o,p=a,m=i,g=">",y=">=";break;case"<":d=i,p=c,m=o,g="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(u,l,h))return!1;for(let e=0;e<l.set.length;++e){const n=l.set[e];let s=null,o=null;if(n.forEach((e=>{e.semver===r&&(e=new t(">=0.0.0")),s=s||e,o=o||e,d(e.semver,s.semver,h)?s=e:m(e.semver,o.semver,h)&&(o=e)})),s.operator===g||s.operator===y)return!1;if((!o.operator||o.operator===g)&&p(u,o.semver))return!1;if(o.operator===y&&m(u,o.semver))return!1}return!0},ar}function En(){if(wr)return br;wr=1;const e=Zr(),t=Yr(),r=tn(),n=en(),s=rn(),o=function(){if(et)return Qe;et=1;const e=rn();return Qe=(t,r)=>{const n=e(t,r);return n?n.version:null},Qe}(),i=function(){if(rt)return tt;rt=1;const e=rn();return tt=(t,r)=>{const n=e(t.trim().replace(/^[=v]+/,""),r);return n?n.version:null},tt}(),a=function(){if(st)return nt;st=1;const e=tn();return nt=(t,r,n,s,o)=>{"string"==typeof n&&(o=s,s=n,n=void 0);try{return new e(t instanceof e?t.version:t,n).inc(r,s,o).version}catch(e){return null}},nt}(),c=function(){if(it)return ot;it=1;const e=rn();return ot=(t,r)=>{const n=e(t,null,!0),s=e(r,null,!0),o=n.compare(s);if(0===o)return null;const i=o>0,a=i?n:s,c=i?s:n,u=!!a.prerelease.length;if(c.prerelease.length&&!u){if(!c.patch&&!c.minor)return"major";if(0===c.compareMain(a))return c.minor&&!c.patch?"minor":"patch"}const l=u?"pre":"";return n.major!==s.major?l+"major":n.minor!==s.minor?l+"minor":n.patch!==s.patch?l+"patch":"prerelease"}}(),u=function(){if(ct)return at;ct=1;const e=tn();return at=(t,r)=>new e(t,r).major}(),l=function(){if(lt)return ut;lt=1;const e=tn();return ut=(t,r)=>new e(t,r).minor}(),f=function(){if(ht)return ft;ht=1;const e=tn();return ft=(t,r)=>new e(t,r).patch}(),h=function(){if(pt)return dt;pt=1;const e=rn();return dt=(t,r)=>{const n=e(t,r);return n&&n.prerelease.length?n.prerelease:null},dt}(),d=nn(),p=function(){if(Et)return yt;Et=1;const e=nn();return yt=(t,r,n)=>e(r,t,n)}(),m=function(){if(wt)return bt;wt=1;const e=nn();return bt=(t,r)=>e(t,r,!0)}(),g=sn(),y=function(){if(It)return Nt;It=1;const e=sn();return Nt=(t,r)=>t.sort(((t,n)=>e(t,n,r)))}(),E=function(){if(At)return xt;At=1;const e=sn();return xt=(t,r)=>t.sort(((t,n)=>e(n,t,r)))}(),b=on(),w=an(),v=cn(),S=un(),N=ln(),I=fn(),x=hn(),A=function(){if(Vt)return Ft;Vt=1;const e=tn(),t=rn(),{safeRe:r,t:n}=Zr();return Ft=(s,o)=>{if(s instanceof e)return s;if("number"==typeof s&&(s=String(s)),"string"!=typeof s)return null;let i=null;if((o=o||{}).rtl){const e=o.includePrerelease?r[n.COERCERTLFULL]:r[n.COERCERTL];let t;for(;(t=e.exec(s))&&(!i||i.index+i[0].length!==s.length);)i&&t.index+t[0].length===i.index+i[0].length||(i=t),e.lastIndex=t.index+t[1].length+t[2].length;e.lastIndex=-1}else i=s.match(o.includePrerelease?r[n.COERCEFULL]:r[n.COERCE]);if(null===i)return null;const a=i[2],c=i[3]||"0",u=i[4]||"0",l=o.includePrerelease&&i[5]?`-${i[5]}`:"",f=o.includePrerelease&&i[6]?`+${i[6]}`:"";return t(`${a}.${c}.${u}${l}${f}`,o)},Ft}(),$=pn(),C=dn(),T=mn(),O=function(){if(Zt)return Jt;Zt=1;const e=dn();return Jt=(t,r)=>new e(t,r).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" "))),Jt}(),R=function(){if(er)return Qt;er=1;const e=tn(),t=dn();return Qt=(r,n,s)=>{let o=null,i=null,a=null;try{a=new t(n,s)}catch(e){return null}return r.forEach((t=>{a.test(t)&&(o&&-1!==i.compare(t)||(o=t,i=new e(o,s)))})),o},Qt}(),P=function(){if(rr)return tr;rr=1;const e=tn(),t=dn();return tr=(r,n,s)=>{let o=null,i=null,a=null;try{a=new t(n,s)}catch(e){return null}return r.forEach((t=>{a.test(t)&&(o&&1!==i.compare(t)||(o=t,i=new e(o,s)))})),o},tr}(),k=function(){if(sr)return nr;sr=1;const e=tn(),t=dn(),r=on();return nr=(n,s)=>{n=new t(n,s);let o=new e("0.0.0");if(n.test(o))return o;if(o=new e("0.0.0-0"),n.test(o))return o;o=null;for(let t=0;t<n.set.length;++t){const s=n.set[t];let i=null;s.forEach((t=>{const n=new e(t.semver.version);switch(t.operator){case">":0===n.prerelease.length?n.patch++:n.prerelease.push(0),n.raw=n.format();case"":case">=":i&&!r(n,i)||(i=n);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${t.operator}`)}})),!i||o&&!r(o,i)||(o=i)}return o&&n.test(o)?o:null},nr}(),L=gn(),_=yn(),j=function(){if(lr)return ur;lr=1;const e=yn();return ur=(t,r,n)=>e(t,r,">",n),ur}(),M=function(){if(hr)return fr;hr=1;const e=yn();return fr=(t,r,n)=>e(t,r,"<",n),fr}(),D=function(){if(pr)return dr;pr=1;const e=dn();return dr=(t,r,n)=>(t=new e(t,n),r=new e(r,n),t.intersects(r,n))}(),U=function(){if(gr)return mr;gr=1;const e=mn(),t=nn();return mr=(r,n,s)=>{const o=[];let i=null,a=null;const c=r.sort(((e,r)=>t(e,r,s)));for(const t of c)e(t,n,s)?(a=t,i||(i=t)):(a&&o.push([i,a]),a=null,i=null);i&&o.push([i,null]);const u=[];for(const[e,t]of o)e===t?u.push(e):t||e!==c[0]?t?e===c[0]?u.push(`<=${t}`):u.push(`${e} - ${t}`):u.push(`>=${e}`):u.push("*");const l=u.join(" || "),f="string"==typeof n.raw?n.raw:String(n);return l.length<f.length?l:n},mr}(),B=function(){if(Er)return yr;Er=1;const e=dn(),t=pn(),{ANY:r}=t,n=mn(),s=nn(),o=[new t(">=0.0.0-0")],i=[new t(">=0.0.0")],a=(e,t,a)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===r){if(1===t.length&&t[0].semver===r)return!0;e=a.includePrerelease?o:i}if(1===t.length&&t[0].semver===r){if(a.includePrerelease)return!0;t=i}const l=new Set;let f,h,d,p,m,g,y;for(const t of e)">"===t.operator||">="===t.operator?f=c(f,t,a):"<"===t.operator||"<="===t.operator?h=u(h,t,a):l.add(t.semver);if(l.size>1)return null;if(f&&h){if(d=s(f.semver,h.semver,a),d>0)return null;if(0===d&&(">="!==f.operator||"<="!==h.operator))return null}for(const e of l){if(f&&!n(e,String(f),a))return null;if(h&&!n(e,String(h),a))return null;for(const r of t)if(!n(e,String(r),a))return!1;return!0}let E=!(!h||a.includePrerelease||!h.semver.prerelease.length)&&h.semver,b=!(!f||a.includePrerelease||!f.semver.prerelease.length)&&f.semver;E&&1===E.prerelease.length&&"<"===h.operator&&0===E.prerelease[0]&&(E=!1);for(const e of t){if(y=y||">"===e.operator||">="===e.operator,g=g||"<"===e.operator||"<="===e.operator,f)if(b&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===b.major&&e.semver.minor===b.minor&&e.semver.patch===b.patch&&(b=!1),">"===e.operator||">="===e.operator){if(p=c(f,e,a),p===e&&p!==f)return!1}else if(">="===f.operator&&!n(f.semver,String(e),a))return!1;if(h)if(E&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===E.major&&e.semver.minor===E.minor&&e.semver.patch===E.patch&&(E=!1),"<"===e.operator||"<="===e.operator){if(m=u(h,e,a),m===e&&m!==h)return!1}else if("<="===h.operator&&!n(h.semver,String(e),a))return!1;if(!e.operator&&(h||f)&&0!==d)return!1}return!(f&&g&&!h&&0!==d||h&&y&&!f&&0!==d||b||E)},c=(e,t,r)=>{if(!e)return t;const n=s(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},u=(e,t,r)=>{if(!e)return t;const n=s(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};return yr=(t,r,n={})=>{if(t===r)return!0;t=new e(t,n),r=new e(r,n);let s=!1;e:for(const e of t.set){for(const t of r.set){const r=a(e,t,n);if(s=s||null!==r,r)continue e}if(s)return!1}return!0}}();return br={parse:s,valid:o,clean:i,inc:a,diff:c,major:u,minor:l,patch:f,prerelease:h,compare:d,rcompare:p,compareLoose:m,compareBuild:g,sort:y,rsort:E,gt:b,lt:w,eq:v,neq:S,gte:N,lte:I,cmp:x,coerce:A,Comparator:$,Range:C,satisfies:T,toComparators:O,maxSatisfying:R,minSatisfying:P,minVersion:k,validRange:L,outside:_,gtr:j,ltr:M,intersects:D,simplifyRange:U,subset:B,SemVer:r,re:e.re,src:e.src,tokens:e.t,SEMVER_SPEC_VERSION:t.SEMVER_SPEC_VERSION,RELEASE_TYPES:t.RELEASE_TYPES,compareIdentifiers:n.compareIdentifiers,rcompareIdentifiers:n.rcompareIdentifiers}}function bn(){if(Ar)return xr;Ar=1;const e=function(){if(Sr)return vr;Sr=1;const e=En();return vr=e.satisfies(process.version,">=15.7.0")}(),t=function(){if(Ir)return Nr;Ir=1;const e=En();return Nr=e.satisfies(process.version,">=16.9.0")}(),r={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},n={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};return xr=function(s,o){if(!s||!o)return;const i=o.asymmetricKeyType;if(!i)return;const a=r[i];if(!a)throw new Error(`Unknown key type "${i}".`);if(!a.includes(s))throw new Error(`"alg" parameter for "${i}" key type must be one of: ${a.join(", ")}.`);if(e)switch(i){case"ec":const e=o.asymmetricKeyDetails.namedCurve,r=n[s];if(e!==r)throw new Error(`"alg" parameter "${s}" requires curve "${r}".`);break;case"rsa-pss":if(t){const e=parseInt(s.slice(-3),10),{hashAlgorithm:t,mgf1HashAlgorithm:r,saltLength:n}=o.asymmetricKeyDetails;if(t!==`sha${e}`||r!==t)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${s}.`);if(void 0!==n&&n>e>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${s}.`)}}}}function wn(){if(Cr)return $r;Cr=1;var e=En();return $r=e.satisfies(process.version,"^6.12.0 || >=8.0.0")}function vn(){if(Or)return Tr;Or=1;const e=_e(),t=je(),r=Me(),s=Le(),o=Ue(),i=bn(),a=wn(),c=ke(),{KeyObject:u,createSecretKey:l,createPublicKey:f}=n,h=["RS256","RS384","RS512"],d=["ES256","ES384","ES512"],p=["RS256","RS384","RS512"],m=["HS256","HS384","HS512"];return a&&(h.splice(h.length,0,"PS256","PS384","PS512"),p.splice(p.length,0,"PS256","PS384","PS512")),Tr=function(n,a,g,y){let E;if("function"!=typeof g||y||(y=g,g={}),g||(g={}),g=Object.assign({},g),E=y||function(e,t){if(e)throw e;return t},g.clockTimestamp&&"number"!=typeof g.clockTimestamp)return E(new e("clockTimestamp must be a number"));if(void 0!==g.nonce&&("string"!=typeof g.nonce||""===g.nonce.trim()))return E(new e("nonce must be a non-empty string"));if(void 0!==g.allowInvalidAsymmetricKeyTypes&&"boolean"!=typeof g.allowInvalidAsymmetricKeyTypes)return E(new e("allowInvalidAsymmetricKeyTypes must be a boolean"));const b=g.clockTimestamp||Math.floor(Date.now()/1e3);if(!n)return E(new e("jwt must be provided"));if("string"!=typeof n)return E(new e("jwt must be a string"));const w=n.split(".");if(3!==w.length)return E(new e("jwt malformed"));let v;try{v=s(n,{complete:!0})}catch(e){return E(e)}if(!v)return E(new e("invalid token"));const S=v.header;let N;if("function"==typeof a){if(!y)return E(new e("verify must be called asynchronous if secret or public key is provided as a callback"));N=a}else N=function(e,t){return t(null,a)};return N(S,(function(s,a){if(s)return E(new e("error in secret or public key callback: "+s.message));const y=""!==w[2].trim();if(!y&&a)return E(new e("jwt signature is required"));if(y&&!a)return E(new e("secret or public key must be provided"));if(!y&&!g.algorithms)return E(new e('please specify "none" in "algorithms" to verify unsigned tokens'));if(null!=a&&!(a instanceof u))try{a=f(a)}catch(t){try{a=l("string"==typeof a?Buffer.from(a):a)}catch(t){return E(new e("secretOrPublicKey is not valid key material"))}}if(g.algorithms||("secret"===a.type?g.algorithms=m:["rsa","rsa-pss"].includes(a.asymmetricKeyType)?g.algorithms=p:"ec"===a.asymmetricKeyType?g.algorithms=d:g.algorithms=h),-1===g.algorithms.indexOf(v.header.alg))return E(new e("invalid algorithm"));if(S.alg.startsWith("HS")&&"secret"!==a.type)return E(new e(`secretOrPublicKey must be a symmetric key when using ${S.alg}`));if(/^(?:RS|PS|ES)/.test(S.alg)&&"public"!==a.type)return E(new e(`secretOrPublicKey must be an asymmetric key when using ${S.alg}`));if(!g.allowInvalidAsymmetricKeyTypes)try{i(S.alg,a)}catch(e){return E(e)}let N;try{N=c.verify(n,v.header.alg,a)}catch(e){return E(e)}if(!N)return E(new e("invalid signature"));const I=v.payload;if(void 0!==I.nbf&&!g.ignoreNotBefore){if("number"!=typeof I.nbf)return E(new e("invalid nbf value"));if(I.nbf>b+(g.clockTolerance||0))return E(new t("jwt not active",new Date(1e3*I.nbf)))}if(void 0!==I.exp&&!g.ignoreExpiration){if("number"!=typeof I.exp)return E(new e("invalid exp value"));if(b>=I.exp+(g.clockTolerance||0))return E(new r("jwt expired",new Date(1e3*I.exp)))}if(g.audience){const t=Array.isArray(g.audience)?g.audience:[g.audience];if(!(Array.isArray(I.aud)?I.aud:[I.aud]).some((function(e){return t.some((function(t){return t instanceof RegExp?t.test(e):t===e}))})))return E(new e("jwt audience invalid. expected: "+t.join(" or ")))}if(g.issuer){if("string"==typeof g.issuer&&I.iss!==g.issuer||Array.isArray(g.issuer)&&-1===g.issuer.indexOf(I.iss))return E(new e("jwt issuer invalid. expected: "+g.issuer))}if(g.subject&&I.sub!==g.subject)return E(new e("jwt subject invalid. expected: "+g.subject));if(g.jwtid&&I.jti!==g.jwtid)return E(new e("jwt jwtid invalid. expected: "+g.jwtid));if(g.nonce&&I.nonce!==g.nonce)return E(new e("jwt nonce invalid. expected: "+g.nonce));if(g.maxAge){if("number"!=typeof I.iat)return E(new e("iat required when maxAge is specified"));const t=o(g.maxAge,I.iat);if(void 0===t)return E(new e('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(b>=t+(g.clockTolerance||0))return E(new r("maxAge exceeded",new Date(1e3*t)))}if(!0===g.complete){const e=v.signature;return E(null,{header:S,payload:I,signature:e})}return E(null,I)}))},Tr}function Sn(){if(Pr)return Rr;Pr=1;var e=1/0,t=9007199254740991,r=17976931348623157e292,n=NaN,s="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",a="[object String]",c="[object Symbol]",u=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,h=/^0o[0-7]+$/i,d=/^(?:0|[1-9]\d*)$/,p=parseInt;function m(e){return e!=e}function g(e,t){return function(e,t){for(var r=-1,n=e?e.length:0,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}(t,(function(t){return e[t]}))}var y,E,b=Object.prototype,w=b.hasOwnProperty,v=b.toString,S=b.propertyIsEnumerable,N=(y=Object.keys,E=Object,function(e){return y(E(e))}),I=Math.max;function x(e,t){var r=C(e)||function(e){return function(e){return R(e)&&T(e)}(e)&&w.call(e,"callee")&&(!S.call(e,"callee")||v.call(e)==s)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,o=!!n;for(var i in e)!w.call(e,i)||o&&("length"==i||$(i,n))||r.push(i);return r}function A(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||b,t!==n)return N(e);var t,r,n,s=[];for(var o in Object(e))w.call(e,o)&&"constructor"!=o&&s.push(o);return s}function $(e,r){return!!(r=null==r?t:r)&&("number"==typeof e||d.test(e))&&e>-1&&e%1==0&&e<r}var C=Array.isArray;function T(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=t}(e.length)&&!function(e){var t=O(e)?v.call(e):"";return t==o||t==i}(e)}function O(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function R(e){return!!e&&"object"==typeof e}return Rr=function(t,s,o,i){var d;t=T(t)?t:(d=t)?g(d,function(e){return T(e)?x(e):A(e)}(d)):[],o=o&&!i?function(t){var s=function(t){if(!t)return 0===t?t:0;if(t=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||R(e)&&v.call(e)==c}(e))return n;if(O(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=O(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(u,"");var r=f.test(e);return r||h.test(e)?p(e.slice(2),r?2:8):l.test(e)?n:+e}(t),t===e||t===-1/0){return(t<0?-1:1)*r}return t==t?t:0}(t),o=s%1;return s==s?o?s-o:s:0}(o):0;var y=t.length;return o<0&&(o=I(y+o,0)),function(e){return"string"==typeof e||!C(e)&&R(e)&&v.call(e)==a}(t)?o<=y&&t.indexOf(s,o)>-1:!!y&&function(e,t,r){if(t!=t)return function(e,t,r){for(var n=e.length,s=r+-1;++s<n;)if(t(e[s],s,e))return s;return-1}(e,m,r);for(var n=r-1,s=e.length;++n<s;)if(e[n]===t)return n;return-1}(t,s,o)>-1}}function Nn(){if(jr)return _r;jr=1;var e=1/0,t=17976931348623157e292,r=NaN,n="[object Symbol]",s=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,a=/^0o[0-7]+$/i,c=parseInt,u=Object.prototype.toString;function l(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}return _r=function(f){return"number"==typeof f&&f==function(f){var h=function(f){if(!f)return 0===f?f:0;if(f=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&u.call(e)==n}(e))return r;if(l(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=l(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var f=i.test(e);return f||a.test(e)?c(e.slice(2),f?2:8):o.test(e)?r:+e}(f),f===e||f===-1/0){return(f<0?-1:1)*t}return f==f?f:0}(f),d=h%1;return h==h?d?h-d:h:0}(f)}}function In(){if(Kr)return zr;Kr=1;var e=1/0,t=17976931348623157e292,r=NaN,n="[object Symbol]",s=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,a=/^0o[0-7]+$/i,c=parseInt,u=Object.prototype.toString;function l(l,h){var d;if("function"!=typeof h)throw new TypeError("Expected a function");return l=function(l){var h=function(l){if(!l)return 0===l?l:0;if(l=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&u.call(e)==n}(e))return r;if(f(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=f(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var l=i.test(e);return l||a.test(e)?c(e.slice(2),l?2:8):o.test(e)?r:+e}(l),l===e||l===-1/0){return(l<0?-1:1)*t}return l==l?l:0}(l),d=h%1;return h==h?d?h-d:h:0}(l),function(){return--l>0&&(d=h.apply(this,arguments)),l<=1&&(h=void 0),d}}function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}return zr=function(e){return l(2,e)}}function xn(){if(Hr)return qr;Hr=1;const e=Ue(),t=wn(),r=bn(),s=ke(),o=Sn(),i=function(){if(Lr)return kr;Lr=1;var e=Object.prototype.toString;return kr=function(t){return!0===t||!1===t||function(e){return!!e&&"object"==typeof e}(t)&&"[object Boolean]"==e.call(t)}}(),a=Nn(),c=function(){if(Dr)return Mr;Dr=1;var e=Object.prototype.toString;return Mr=function(t){return"number"==typeof t||function(e){return!!e&&"object"==typeof e}(t)&&"[object Number]"==e.call(t)}}(),u=function(){if(Br)return Ur;Br=1;var e,t,r=Function.prototype,n=Object.prototype,s=r.toString,o=n.hasOwnProperty,i=s.call(Object),a=n.toString,c=(e=Object.getPrototypeOf,t=Object,function(r){return e(t(r))});return Ur=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=a.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=c(e);if(null===t)return!0;var r=o.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&s.call(r)==i}}(),l=function(){if(Vr)return Fr;Vr=1;var e=Object.prototype.toString,t=Array.isArray;return Fr=function(r){return"string"==typeof r||!t(r)&&function(e){return!!e&&"object"==typeof e}(r)&&"[object String]"==e.call(r)}}(),f=In(),{KeyObject:h,createSecretKey:d,createPrivateKey:p}=n,m=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];t&&m.splice(3,0,"PS256","PS384","PS512");const g={expiresIn:{isValid:function(e){return a(e)||l(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return a(e)||l(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return l(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:o.bind(null,m),message:'"algorithm" must be a valid string enum value'},header:{isValid:u,message:'"header" must be an object'},encoding:{isValid:l,message:'"encoding" must be a string'},issuer:{isValid:l,message:'"issuer" must be a string'},subject:{isValid:l,message:'"subject" must be a string'},jwtid:{isValid:l,message:'"jwtid" must be a string'},noTimestamp:{isValid:i,message:'"noTimestamp" must be a boolean'},keyid:{isValid:l,message:'"keyid" must be a string'},mutatePayload:{isValid:i,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:i,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:i,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},y={iat:{isValid:c,message:'"iat" should be a number of seconds'},exp:{isValid:c,message:'"exp" should be a number of seconds'},nbf:{isValid:c,message:'"nbf" should be a number of seconds'}};function E(e,t,r,n){if(!u(r))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(r).forEach((function(s){const o=e[s];if(o){if(!o.isValid(r[s]))throw new Error(o.message)}else if(!t)throw new Error('"'+s+'" is not allowed in "'+n+'"')}))}const b={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},w=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];return qr=function(t,n,o,i){"function"==typeof o?(i=o,o={}):o=o||{};const a="object"==typeof t&&!Buffer.isBuffer(t),c=Object.assign({alg:o.algorithm||"HS256",typ:a?"JWT":void 0,kid:o.keyid},o.header);function u(e){if(i)return i(e);throw e}if(!n&&"none"!==o.algorithm)return u(new Error("secretOrPrivateKey must have a value"));if(null!=n&&!(n instanceof h))try{n=p(n)}catch(e){try{n=d("string"==typeof n?Buffer.from(n):n)}catch(e){return u(new Error("secretOrPrivateKey is not valid key material"))}}if(c.alg.startsWith("HS")&&"secret"!==n.type)return u(new Error(`secretOrPrivateKey must be a symmetric key when using ${c.alg}`));if(/^(?:RS|PS|ES)/.test(c.alg)){if("private"!==n.type)return u(new Error(`secretOrPrivateKey must be an asymmetric key when using ${c.alg}`));if(!o.allowInsecureKeySizes&&!c.alg.startsWith("ES")&&void 0!==n.asymmetricKeyDetails&&n.asymmetricKeyDetails.modulusLength<2048)return u(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${c.alg}`))}if(void 0===t)return u(new Error("payload is required"));if(a){try{!function(e){E(y,!0,e,"payload")}(t)}catch(e){return u(e)}o.mutatePayload||(t=Object.assign({},t))}else{const e=w.filter((function(e){return void 0!==o[e]}));if(e.length>0)return u(new Error("invalid "+e.join(",")+" option for "+typeof t+" payload"))}if(void 0!==t.exp&&void 0!==o.expiresIn)return u(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==t.nbf&&void 0!==o.notBefore)return u(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{!function(e){E(g,!1,e,"options")}(o)}catch(e){return u(e)}if(!o.allowInvalidAsymmetricKeyTypes)try{r(c.alg,n)}catch(e){return u(e)}const l=t.iat||Math.floor(Date.now()/1e3);if(o.noTimestamp?delete t.iat:a&&(t.iat=l),void 0!==o.notBefore){try{t.nbf=e(o.notBefore,l)}catch(e){return u(e)}if(void 0===t.nbf)return u(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==o.expiresIn&&"object"==typeof t){try{t.exp=e(o.expiresIn,l)}catch(e){return u(e)}if(void 0===t.exp)return u(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(b).forEach((function(e){const r=b[e];if(void 0!==o[e]){if(void 0!==t[r])return u(new Error('Bad "options.'+e+'" option. The payload already has an "'+r+'" property.'));t[r]=o[e]}}));const m=o.encoding||"utf8";if("function"!=typeof i){let e=s.sign({header:c,payload:t,secret:n,encoding:m});if(!o.allowInsecureKeySizes&&/^(?:RS|PS)/.test(c.alg)&&e.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${c.alg}`);return e}i=i&&f(i),s.createSign({header:c,privateKey:n,payload:t,encoding:m}).once("error",i).once("done",(function(e){if(!o.allowInsecureKeySizes&&/^(?:RS|PS)/.test(c.alg)&&e.length<256)return i(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${c.alg}`));i(null,e)}))}}var An,$n,Cn,Tn,On,Rn=G(Wr?Gr:(Wr=1,Gr={decode:Le(),verify:vn(),sign:xn(),JsonWebTokenError:_e(),NotBeforeError:je(),TokenExpiredError:Me()}));!function(e){e.HEADER="header",e.QUERY="query"}(An||(An={})),function(e){e.HEADER="header",e.QUERY="query"}($n||($n={})),function(e){e.HTTP="http",e.HTTPS="https"}(Cn||(Cn={})),function(e){e.MD5="md5",e.CRC32="crc32",e.CRC32C="crc32c",e.SHA1="sha1",e.SHA256="sha256"}(Tn||(Tn={})),function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"}(On||(On={}));const Pn="__smithy_context";var kn,Ln;!function(e){e.PROFILE="profile",e.SSO_SESSION="sso-session",e.SERVICES="services"}(kn||(kn={})),function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"}(Ln||(Ln={}));class _n{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?":"!==e.protocol.slice(-1)?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?"/"!==e.path.charAt(0)?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const t=new _n({...e,headers:{...e.headers}});var r;return t.query&&(t.query=(r=t.query,Object.keys(r).reduce(((e,t)=>{const n=r[t];return{...e,[t]:Array.isArray(n)?[...n]:n}}),{}))),t}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&"object"==typeof t.query&&"object"==typeof t.headers}clone(){return _n.clone(this)}}class jn{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return"number"==typeof t.statusCode&&"object"==typeof t.headers}}const Mn="WHEN_SUPPORTED",Dn="WHEN_REQUIRED",Un="WHEN_SUPPORTED",Bn="WHEN_REQUIRED";var Fn,Vn;!function(e){e.MD5="MD5",e.CRC32="CRC32",e.CRC32C="CRC32C",e.CRC64NVME="CRC64NVME",e.SHA1="SHA1",e.SHA256="SHA256"}(Fn||(Fn={})),function(e){e.HEADER="header",e.TRAILER="trailer"}(Vn||(Vn={}));const zn=Fn.CRC32;var Kn;function qn(e,t,r){e.__aws_sdk_context?e.__aws_sdk_context.features||(e.__aws_sdk_context.features={}):e.__aws_sdk_context={features:{}},e.__aws_sdk_context.features[t]=r}!function(e){e.ENV="env",e.CONFIG="shared config entry"}(Kn||(Kn={}));const Hn={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},Gn={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function Wn(e,t,r){return{applyToStack:n=>{n.add(((e,t)=>(r,n)=>async s=>{const{response:o}=await r(s);try{return{response:o,output:await t(o,e)}}catch(e){if(Object.defineProperty(e,"$response",{value:o}),!("$metadata"in e)){const t="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{e.message+="\n  "+t}catch(e){n.logger&&"NoOpLogger"!==n.logger?.constructor?.name?n.logger?.warn?.(t):console.warn(t)}void 0!==e.$responseBodyText&&e.$response&&(e.$response.body=e.$responseBodyText)}throw e}})(e,r),Hn),n.add(((e,t)=>(r,n)=>async s=>{const o=n.endpointV2?.url&&e.urlParser?async()=>e.urlParser(n.endpointV2.url):e.endpoint;if(!o)throw new Error("No valid endpoint provider available.");const i=await t(s.input,{...e,endpoint:o});return r({...s,request:i})})(e,t),Gn)}}}const Xn=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e),Yn=(e,t=0,r=e.byteLength-t)=>{if(!Xn(e))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);return o.from(e,t,r)},Jn=(e,t)=>{if("string"!=typeof e)throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?o.from(e,t):o.from(e)},Zn=/^[A-Za-z0-9+/]*={0,2}$/,Qn=e=>{const t=Jn(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)},es=e=>{let t;if(t="string"==typeof e?Qn(e):e,"object"!=typeof t||"number"!=typeof t.byteOffset||"number"!=typeof t.byteLength)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");return Yn(t.buffer,t.byteOffset,t.byteLength).toString("base64")};function ts(e,t="utf-8"){return"base64"===t?es(e):(e=>{if("string"==typeof e)return e;if("object"!=typeof e||"number"!=typeof e.byteOffset||"number"!=typeof e.byteLength)throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return Yn(e.buffer,e.byteOffset,e.byteLength).toString("utf8")})(e)}function rs(e,t){return"base64"===t?ns.mutate((e=>{if(3*e.length%4!=0)throw new TypeError("Incorrect padding on base64 string.");if(!Zn.exec(e))throw new TypeError("Invalid base64 string.");const t=Jn(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)})(e)):ns.mutate(Qn(e))}class ns extends Uint8Array{static fromString(e,t="utf-8"){if("string"==typeof e)return rs(e,t);throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,ns.prototype),e}transformToString(e="utf-8"){return ts(this,e)}}let ss=class extends a{constructor({expectedChecksum:e,checksum:t,source:r,checksumSourceLocation:n,base64Encoder:s}){if(super(),"function"!=typeof r.pipe)throw new Error(`@smithy/util-stream: unsupported source type ${r?.constructor?.name??r} in ChecksumStream.`);this.source=r,this.base64Encoder=s??es,this.expectedChecksum=e,this.checksum=t,this.checksumSourceLocation=n,this.source.pipe(this)}_read(e){}_write(e,t,r){try{this.checksum.update(e),this.push(e)}catch(e){return r(e)}return r()}async _final(e){try{const t=await this.checksum.digest(),r=this.base64Encoder(t);if(this.expectedChecksum!==r)return e(new Error(`Checksum mismatch: expected "${this.expectedChecksum}" but received "${r}" in response header "${this.checksumSourceLocation}".`))}catch(t){return e(t)}return this.push(null),e()}};const os=e=>"function"==typeof ReadableStream&&(e?.constructor?.name===ReadableStream.name||e instanceof ReadableStream),is="function"==typeof ReadableStream?ReadableStream:function(){};class as extends is{}function cs(e){return"function"==typeof ReadableStream&&os(e.source)?(({expectedChecksum:e,checksum:t,source:r,checksumSourceLocation:n,base64Encoder:s})=>{if(!os(r))throw new Error(`@smithy/util-stream: unsupported source type ${r?.constructor?.name??r} in ChecksumStream.`);const o=s??es;if("function"!=typeof TransformStream)throw new Error("@smithy/util-stream: unable to instantiate ChecksumStream because API unavailable: ReadableStream/TransformStream.");const i=new TransformStream({start(){},async transform(e,r){t.update(e),r.enqueue(e)},async flush(r){const s=await t.digest(),i=o(s);if(e!==i){const t=new Error(`Checksum mismatch: expected "${e}" but received "${i}" in response header "${n}".`);r.error(t)}else r.terminate()}});r.pipeThrough(i);const a=i.readable;return Object.setPrototypeOf(a,as.prototype),a})(e):new ss(e)}class us{constructor(e){this.allocByteArray=e,this.byteLength=0,this.byteArrays=[]}push(e){this.byteArrays.push(e),this.byteLength+=e.byteLength}flush(){if(1===this.byteArrays.length){const e=this.byteArrays[0];return this.reset(),e}const e=this.allocByteArray(this.byteLength);let t=0;for(let r=0;r<this.byteArrays.length;++r){const n=this.byteArrays[r];e.set(n,t),t+=n.byteLength}return this.reset(),e}reset(){this.byteArrays=[],this.byteLength=0}}function ls(e,t,r){switch(t){case 0:return e[0]+=r,hs(e[0]);case 1:case 2:return e[t].push(r),hs(e[t])}}function fs(e,t){switch(t){case 0:const r=e[0];return e[0]="",r;case 1:case 2:return e[t].flush()}throw new Error(`@smithy/util-stream - invalid index ${t} given to flush()`)}function hs(e){return e?.byteLength??e?.length??0}function ds(e,t=!0){return t&&"undefined"!=typeof Buffer&&e instanceof Buffer?2:e instanceof Uint8Array?1:"string"==typeof e?0:-1}function ps(e,t,r){if(os(e))return function(e,t,r){const n=e.getReader();let s=!1,o=0;const i=["",new us((e=>new Uint8Array(e)))];let a=-1;const c=async e=>{const{value:u,done:l}=await n.read(),f=u;if(l){if(-1!==a){const t=fs(i,a);hs(t)>0&&e.enqueue(t)}e.close()}else{const n=ds(f,!1);if(a!==n&&(a>=0&&e.enqueue(fs(i,a)),a=n),-1===a)return void e.enqueue(f);const u=hs(f);o+=u;const l=hs(i[a]);if(u>=t&&0===l)e.enqueue(f);else{const n=ls(i,a,f);!s&&o>2*t&&(s=!0,r?.warn(`@smithy/util-stream - stream chunk size ${u} is below threshold of ${t}, automatically buffering.`)),n>=t?e.enqueue(fs(i,a)):await c(e)}}};return new ReadableStream({pull:c})}(e,t,r);const n=new h({read(){}});let s=!1,o=0;const i=["",new us((e=>new Uint8Array(e))),new us((e=>Buffer.from(new Uint8Array(e))))];let a=-1;return e.on("data",(e=>{const c=ds(e,!0);if(a!==c&&(a>=0&&n.push(fs(i,a)),a=c),-1===a)return void n.push(e);const u=hs(e);o+=u;const l=hs(i[a]);if(u>=t&&0===l)n.push(e);else{const c=ls(i,a,e);!s&&o>2*t&&(s=!0,r?.warn(`@smithy/util-stream - stream chunk size ${u} is below threshold of ${t}, automatically buffering.`)),c>=t&&n.push(fs(i,a))}})),e.on("end",(()=>{if(-1!==a){const e=fs(i,a);hs(e)>0&&n.push(e)}n.push(null)})),n}const ms=(e,t)=>os(e)?async function(e,t){let r=0;const n=[],s=e.getReader();let o=!1;for(;!o;){const{done:e,value:i}=await s.read();if(i&&(n.push(i),r+=i?.byteLength??0),r>=t)break;o=e}s.releaseLock();const i=new Uint8Array(Math.min(t,r));let a=0;for(const e of n){if(e.byteLength>i.byteLength-a){i.set(e.subarray(0,i.byteLength-a),a);break}i.set(e,a),a+=e.length}return i}(e,t):new Promise(((r,n)=>{const s=new gs;s.limit=t,e.pipe(s),e.on("error",(e=>{s.end(),n(e)})),s.on("error",n),s.on("finish",(function(){const e=new Uint8Array(Buffer.concat(this.buffers));r(e)}))}));class gs extends c{constructor(){super(...arguments),this.buffers=[],this.limit=1/0,this.bytesBuffered=0}_write(e,t,r){if(this.buffers.push(e),this.bytesBuffered+=e.byteLength??0,this.bytesBuffered>=this.limit){const e=this.bytesBuffered-this.limit,t=this.buffers[this.buffers.length-1];this.buffers[this.buffers.length-1]=t.subarray(0,t.byteLength-e),this.emit("finish")}r()}}for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`)}async function ys(e){if(os(e)||(t=e,"function"==typeof Blob&&(t?.constructor?.name===Blob.name||t instanceof Blob)))return async function(e){return"function"==typeof e.stream&&(e=e.stream()),e.tee()}(e);var t;const r=new u,n=new u;return e.pipe(r),e.pipe(n),[r,n]}const Es=async(e=new Uint8Array,t)=>{if(e instanceof Uint8Array)return ns.mutate(e);if(!e)return ns.mutate(new Uint8Array);const r=t.streamCollector(e);return ns.mutate(await r)};function bs(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function ws(e,t){return new vs(e,t)}class vs{constructor(e,t){this.input=e,this.context=t,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){const{hostname:e,protocol:t="https",port:r,path:n}=await this.context.endpoint();this.path=n;for(const e of this.resolvePathStack)e(this.path);return new _n({protocol:t,hostname:this.hostname||e,port:r,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(e){return this.hostname=e,this}bp(e){return this.resolvePathStack.push((t=>{this.path=`${t?.endsWith("/")?t.slice(0,-1):t||""}`+e})),this}p(e,t,r,n){return this.resolvePathStack.push((s=>{this.path=((e,t,r,n,s,o)=>{if(null==t||void 0===t[r])throw new Error("No value provided for input HTTP label: "+r+".");{const t=n();if(t.length<=0)throw new Error("Empty value provided for input HTTP label: "+r+".");e=e.replace(s,o?t.split("/").map((e=>bs(e))).join("/"):bs(t))}return e})(s,this.input,e,t,r,n)})),this}h(e){return this.headers=e,this}q(e){return this.query=e,this}b(e){return this.body=e,this}m(e){return this.method=e,this}}class Ss extends Error{constructor(e,t=!0){let r,n=!0;"boolean"==typeof t?(r=void 0,n=t):null!=t&&"object"==typeof t&&(r=t.logger,n=t.tryNextLink??!0),super(e),this.name="ProviderError",this.tryNextLink=n,Object.setPrototypeOf(this,Ss.prototype),r?.debug?.(`@smithy/property-provider ${n?"->":"(!)"} ${e}`)}static from(e,t=!0){return Object.assign(new this(e.message,t),e)}}class Ns extends Ss{constructor(e,t=!0){super(e,t),this.name="CredentialsProviderError",Object.setPrototypeOf(this,Ns.prototype)}}const Is=(e,t,r)=>{let n,s,o,i=!1;return async t=>(o&&!t?.forceRefresh||(n=await(async()=>{s||(s=e());try{n=await s,o=!0,i=!1}finally{s=void 0}return n})()),n)};var xs;!function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"}(xs||(xs={}));const As=(e,t)=>{const r=[];if(e&&r.push(e),t)for(const e of t)r.push(e);return r},$s=(e,t)=>`${e||"anonymous"}${t&&t.length>0?` (a.k.a. ${t.join(",")})`:""}`,Cs=()=>{let e=[],t=[],r=!1;const n=new Set,s=r=>(e.forEach((e=>{r.add(e.middleware,{...e})})),t.forEach((e=>{r.addRelativeTo(e.middleware,{...e})})),r.identifyOnResolve?.(a.identifyOnResolve()),r),o=e=>{const t=[];return e.before.forEach((e=>{0===e.before.length&&0===e.after.length?t.push(e):t.push(...o(e))})),t.push(e),e.after.reverse().forEach((e=>{0===e.before.length&&0===e.after.length?t.push(e):t.push(...o(e))})),t},i=(r=!1)=>{const n=[],s=[],i={};e.forEach((e=>{const t={...e,before:[],after:[]};for(const e of As(t.name,t.aliases))i[e]=t;n.push(t)})),t.forEach((e=>{const t={...e,before:[],after:[]};for(const e of As(t.name,t.aliases))i[e]=t;s.push(t)})),s.forEach((e=>{if(e.toMiddleware){const t=i[e.toMiddleware];if(void 0===t){if(r)return;throw new Error(`${e.toMiddleware} is not found when adding ${$s(e.name,e.aliases)} middleware ${e.relation} ${e.toMiddleware}`)}"after"===e.relation&&t.after.push(e),"before"===e.relation&&t.before.push(e)}}));var a;return(a=n,a.sort(((e,t)=>Ts[t.step]-Ts[e.step]||Os[t.priority||"normal"]-Os[e.priority||"normal"]))).map(o).reduce(((e,t)=>(e.push(...t),e)),[])},a={add:(t,r={})=>{const{name:s,override:o,aliases:i}=r,a={step:"initialize",priority:"normal",middleware:t,...r},c=As(s,i);if(c.length>0){if(c.some((e=>n.has(e)))){if(!o)throw new Error(`Duplicate middleware name '${$s(s,i)}'`);for(const t of c){const r=e.findIndex((e=>e.name===t||e.aliases?.some((e=>e===t))));if(-1===r)continue;const n=e[r];if(n.step!==a.step||a.priority!==n.priority)throw new Error(`"${$s(n.name,n.aliases)}" middleware with ${n.priority} priority in ${n.step} step cannot be overridden by "${$s(s,i)}" middleware with ${a.priority} priority in ${a.step} step.`);e.splice(r,1)}}for(const e of c)n.add(e)}e.push(a)},addRelativeTo:(e,r)=>{const{name:s,override:o,aliases:i}=r,a={middleware:e,...r},c=As(s,i);if(c.length>0){if(c.some((e=>n.has(e)))){if(!o)throw new Error(`Duplicate middleware name '${$s(s,i)}'`);for(const e of c){const r=t.findIndex((t=>t.name===e||t.aliases?.some((t=>t===e))));if(-1===r)continue;const n=t[r];if(n.toMiddleware!==a.toMiddleware||n.relation!==a.relation)throw new Error(`"${$s(n.name,n.aliases)}" middleware ${n.relation} "${n.toMiddleware}" middleware cannot be overridden by "${$s(s,i)}" middleware ${a.relation} "${a.toMiddleware}" middleware.`);t.splice(r,1)}}for(const e of c)n.add(e)}t.push(a)},clone:()=>s(Cs()),use:e=>{e.applyToStack(a)},remove:r=>"string"==typeof r?(r=>{let s=!1;const o=e=>{const t=As(e.name,e.aliases);if(t.includes(r)){s=!0;for(const e of t)n.delete(e);return!1}return!0};return e=e.filter(o),t=t.filter(o),s})(r):(r=>{let s=!1;const o=e=>{if(e.middleware===r){s=!0;for(const t of As(e.name,e.aliases))n.delete(t);return!1}return!0};return e=e.filter(o),t=t.filter(o),s})(r),removeByTag:r=>{let s=!1;const o=e=>{const{tags:t,name:o,aliases:i}=e;if(t&&t.includes(r)){const e=As(o,i);for(const t of e)n.delete(t);return s=!0,!1}return!0};return e=e.filter(o),t=t.filter(o),s},concat:e=>{const t=s(Cs());return t.use(e),t.identifyOnResolve(r||t.identifyOnResolve()||(e.identifyOnResolve?.()??!1)),t},applyToStack:s,identify:()=>i(!0).map((e=>{const t=e.step??e.relation+" "+e.toMiddleware;return $s(e.name,e.aliases)+" - "+t})),identifyOnResolve:e=>("boolean"==typeof e&&(r=e),r),resolve:(e,t)=>{for(const r of i().map((e=>e.middleware)).reverse())e=r(e,t);return r&&console.log(a.identify()),e}};return a},Ts={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},Os={high:3,normal:2,low:1};class Rs{constructor(){this.middlewareStack=Cs()}static classBuilder(){return new Ps}resolveMiddlewareWithContext(e,t,r,{middlewareFn:n,clientName:s,commandName:o,inputFilterSensitiveLog:i,outputFilterSensitiveLog:a,smithyContext:c,additionalContext:u,CommandCtor:l}){for(const s of n.bind(this)(l,e,t,r))this.middlewareStack.use(s);const f=e.concat(this.middlewareStack),{logger:h}=t,d={logger:h,clientName:s,commandName:o,inputFilterSensitiveLog:i,outputFilterSensitiveLog:a,[Pn]:{commandInstance:this,...c},...u},{requestHandler:p}=t;return f.resolve((e=>p.handle(e.request,r||{})),d)}}class Ps{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=e=>e,this._outputFilterSensitiveLog=e=>e,this._serializer=null,this._deserializer=null}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,t,r={}){return this._smithyContext={service:e,operation:t,...r},this}c(e={}){return this._additionalContext=e,this}n(e,t){return this._clientName=e,this._commandName=t,this}f(e=e=>e,t=e=>e){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=t,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}build(){const e=this;let t;return t=class extends Rs{static getEndpointParameterInstructions(){return e._ep}constructor(...[t]){super(),this.serialize=e._serializer,this.deserialize=e._deserializer,this.input=t??{},e._init(this)}resolveMiddleware(r,n,s){return this.resolveMiddlewareWithContext(r,n,s,{CommandCtor:t,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog,outputFilterSensitiveLog:e._outputFilterSensitiveLog,smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}const ks="***SensitiveInformation***",Ls=e=>{switch(e){case"true":return!0;case"false":return!1;default:throw new Error(`Unable to parse boolean value "${e}"`)}},_s=Math.ceil(2**127*(2-2**-23)),js=e=>{const t=(e=>{if(null!=e){if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&Js.warn(Ys(`Expected number but observed string: ${e}`)),t}if("number"==typeof e)return e;throw new TypeError(`Expected number, got ${typeof e}: ${e}`)}})(e);if(void 0!==t&&!Number.isNaN(t)&&t!==1/0&&t!==-1/0&&Math.abs(t)>_s)throw new TypeError(`Expected 32-bit float, got ${e}`);return t},Ms=e=>{if(null!=e){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError(`Expected integer, got ${typeof e}: ${e}`)}},Ds=e=>Fs(e,32),Us=e=>Fs(e,16),Bs=e=>Fs(e,8),Fs=(e,t)=>{const r=Ms(e);if(void 0!==r&&Vs(r,t)!==r)throw new TypeError(`Expected ${t}-bit integer, got ${e}`);return r},Vs=(e,t)=>{switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}},zs=(e,t)=>{if(null==e)throw new TypeError("Expected a non-null value");return e},Ks=e=>{if(null!=e){if("string"==typeof e)return e;if(["boolean","number","bigint"].includes(typeof e))return Js.warn(Ys(`Expected string, got ${typeof e}: ${e}`)),String(e);throw new TypeError(`Expected string, got ${typeof e}: ${e}`)}},qs=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,Hs=e=>{const t=e.match(qs);if(null===t||t[0].length!==e.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(e)},Gs=e=>Ms("string"==typeof e?Hs(e):e),Ws=e=>Ds("string"==typeof e?Hs(e):e),Xs=e=>Us("string"==typeof e?Hs(e):e),Ys=e=>String(new TypeError(e).stack||e).split("\n").slice(0,5).filter((e=>!e.includes("stackTraceWarning"))).join("\n"),Js={warn:console.warn},Zs=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Qs=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function eo(e){const t=e.getUTCFullYear(),r=e.getUTCMonth(),n=e.getUTCDay(),s=e.getUTCDate(),o=e.getUTCHours(),i=e.getUTCMinutes(),a=e.getUTCSeconds(),c=o<10?`0${o}`:`${o}`,u=i<10?`0${i}`:`${i}`,l=a<10?`0${a}`:`${a}`;return`${Zs[n]}, ${s<10?`0${s}`:`${s}`} ${Qs[r]} ${t} ${c}:${u}:${l} GMT`}const to=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),ro=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),no=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),so=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),oo=e=>{if(null==e)return;if("string"!=typeof e)throw new TypeError("RFC-7231 date-times must be expressed as strings");let t=ro.exec(e);if(t){const[e,r,n,s,o,i,a,c]=t;return io(Xs(yo(s)),uo(n),po(r,"day",1,31),{hours:o,minutes:i,seconds:a,fractionalMilliseconds:c})}if(t=no.exec(e),t){const[e,r,n,s,o,i,a,c]=t;return co(io(ao(s),uo(n),po(r,"day",1,31),{hours:o,minutes:i,seconds:a,fractionalMilliseconds:c}))}if(t=so.exec(e),t){const[e,r,n,s,o,i,a,c]=t;return io(Xs(yo(c)),uo(r),po(n.trimLeft(),"day",1,31),{hours:s,minutes:o,seconds:i,fractionalMilliseconds:a})}throw new TypeError("Invalid RFC-7231 date-time value")},io=(e,t,r,n)=>{const s=t-1;return fo(e,s,r),new Date(Date.UTC(e,s,r,po(n.hours,"hour",0,23),po(n.minutes,"minute",0,59),po(n.seconds,"seconds",0,60),mo(n.fractionalMilliseconds)))},ao=e=>{const t=(new Date).getUTCFullYear(),r=100*Math.floor(t/100)+Xs(yo(e));return r<t?r+100:r},co=e=>e.getTime()-(new Date).getTime()>15768e8?new Date(Date.UTC(e.getUTCFullYear()-100,e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())):e,uo=e=>{const t=Qs.indexOf(e);if(t<0)throw new TypeError(`Invalid month: ${e}`);return t+1},lo=[31,28,31,30,31,30,31,31,30,31,30,31],fo=(e,t,r)=>{let n=lo[t];if(1===t&&ho(e)&&(n=29),r>n)throw new TypeError(`Invalid day for ${Qs[t]} in ${e}: ${r}`)},ho=e=>e%4==0&&(e%100!=0||e%400==0),po=(e,t,r,n)=>{const s=(e=>Bs("string"==typeof e?Hs(e):e))(yo(e));if(s<r||s>n)throw new TypeError(`${t} must be between ${r} and ${n}, inclusive`);return s},mo=e=>null==e?0:1e3*(e=>js("string"==typeof e?Hs(e):e))("0."+e),go=e=>{const t=e[0];let r=1;if("+"==t)r=1;else{if("-"!=t)throw new TypeError(`Offset direction, ${t}, must be "+" or "-"`);r=-1}return r*(60*Number(e.substring(1,3))+Number(e.substring(4,6)))*60*1e3},yo=e=>{let t=0;for(;t<e.length-1&&"0"===e.charAt(t);)t++;return 0===t?e:e.slice(t)};class Eo extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}static isInstance(e){if(!e)return!1;const t=e;return Eo.prototype.isPrototypeOf(t)||Boolean(t.$fault)&&Boolean(t.$metadata)&&("client"===t.$fault||"server"===t.$fault)}static[Symbol.hasInstance](e){if(!e)return!1;const t=e;return this===Eo?Eo.isInstance(e):!!Eo.isInstance(e)&&(t.name&&this.name?this.prototype.isPrototypeOf(e)||t.name===this.name:this.prototype.isPrototypeOf(e))}}const bo=(e,t={})=>{Object.entries(t).filter((([,e])=>void 0!==e)).forEach((([t,r])=>{null!=e[t]&&""!==e[t]||(e[t]=r)}));const r=e.message||e.Message||"UnknownError";return e.message=r,delete e.Message,e},wo=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),vo=e=>{const t="#text";for(const r in e)e.hasOwnProperty(r)&&void 0!==e[r][t]?e[r]=e[r][t]:"object"==typeof e[r]&&null!==e[r]&&(e[r]=vo(e[r]));return e},So=e=>null!=e;class No{trace(){}debug(){}info(){}warn(){}error(){}}function Io(e,t,r){let n,s,o;if(void 0===t&&void 0===r)n={},o=e;else{if(n=e,"function"==typeof t)return s=t,o=r,xo(n,s,o);o=t}for(const e of Object.keys(o))Array.isArray(o[e])?Ao(n,null,o,e):n[e]=o[e];return n}const xo=(e,t,r)=>Io(e,Object.entries(r).reduce(((e,[r,n])=>(Array.isArray(n)?e[r]=n:e[r]="function"==typeof n?[t,n()]:[t,n],e)),{})),Ao=(e,t,r,n)=>{let[s,o]=r[n];if("function"==typeof o){let t;const r=void 0===s&&null!=(t=o()),i="function"==typeof s&&!!s(void 0)||"function"!=typeof s&&!!s;r?e[n]=t:i&&(e[n]=o())}else{const t=void 0===s&&null!=o,r="function"==typeof s&&!!s(o)||"function"!=typeof s&&!!s;(t||r)&&(e[n]=o)}};var $o,Co,To={},Oo={};function Ro(){return $o||($o=1,function(e){const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r="["+t+"]["+(t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040")+"]*",n=new RegExp("^"+r+"$");e.isExist=function(e){return void 0!==e},e.isEmptyObject=function(e){return 0===Object.keys(e).length},e.merge=function(e,t,r){if(t){const n=Object.keys(t),s=n.length;for(let o=0;o<s;o++)e[n[o]]="strict"===r?[t[n[o]]]:t[n[o]]}},e.getValue=function(t){return e.isExist(t)?t:""},e.isName=function(e){const t=n.exec(e);return!(null==t)},e.getAllMatches=function(e,t){const r=[];let n=t.exec(e);for(;n;){const s=[];s.startIndex=t.lastIndex-n[0].length;const o=n.length;for(let e=0;e<o;e++)s.push(n[e]);r.push(s),n=t.exec(e)}return r},e.nameRegexp=r}(Oo)),Oo}function Po(){if(Co)return To;Co=1;const e=Ro(),t={allowBooleanAttributes:!1,unpairedTags:[]};function r(e){return" "===e||"\t"===e||"\n"===e||"\r"===e}function n(e,t){const r=t;for(;t<e.length;t++)if("?"!=e[t]&&" "!=e[t]);else{const n=e.substr(r,t-r);if(t>5&&"xml"===n)return f("InvalidXml","XML declaration allowed only at the start of the document.",d(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}}return t}function s(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let r=1;for(t+=8;t<e.length;t++)if("<"===e[t])r++;else if(">"===e[t]&&(r--,0===r))break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}To.validate=function(o,i){i=Object.assign({},t,i);const c=[];let h=!1,p=!1;"\ufeff"===o[0]&&(o=o.substr(1));for(let t=0;t<o.length;t++)if("<"===o[t]&&"?"===o[t+1]){if(t+=2,t=n(o,t),t.err)return t}else{if("<"!==o[t]){if(r(o[t]))continue;return f("InvalidChar","char '"+o[t]+"' is not expected.",d(o,t))}{let g=t;if(t++,"!"===o[t]){t=s(o,t);continue}{let y=!1;"/"===o[t]&&(y=!0,t++);let E="";for(;t<o.length&&">"!==o[t]&&" "!==o[t]&&"\t"!==o[t]&&"\n"!==o[t]&&"\r"!==o[t];t++)E+=o[t];if(E=E.trim(),"/"===E[E.length-1]&&(E=E.substring(0,E.length-1),t--),m=E,!e.isName(m)){let e;return e=0===E.trim().length?"Invalid space after '<'.":"Tag '"+E+"' is an invalid name.",f("InvalidTag",e,d(o,t))}const b=a(o,t);if(!1===b)return f("InvalidAttr","Attributes for '"+E+"' have open quote.",d(o,t));let w=b.value;if(t=b.index,"/"===w[w.length-1]){const e=t-w.length;w=w.substring(0,w.length-1);const r=u(w,i);if(!0!==r)return f(r.err.code,r.err.msg,d(o,e+r.err.line));h=!0}else if(y){if(!b.tagClosed)return f("InvalidTag","Closing tag '"+E+"' doesn't have proper closing.",d(o,t));if(w.trim().length>0)return f("InvalidTag","Closing tag '"+E+"' can't have attributes or invalid starting.",d(o,g));if(0===c.length)return f("InvalidTag","Closing tag '"+E+"' has not been opened.",d(o,g));{const e=c.pop();if(E!==e.tagName){let t=d(o,e.tagStartPos);return f("InvalidTag","Expected closing tag '"+e.tagName+"' (opened in line "+t.line+", col "+t.col+") instead of closing tag '"+E+"'.",d(o,g))}0==c.length&&(p=!0)}}else{const e=u(w,i);if(!0!==e)return f(e.err.code,e.err.msg,d(o,t-w.length+e.err.line));if(!0===p)return f("InvalidXml","Multiple possible root nodes found.",d(o,t));-1!==i.unpairedTags.indexOf(E)||c.push({tagName:E,tagStartPos:g}),h=!0}for(t++;t<o.length;t++)if("<"===o[t]){if("!"===o[t+1]){t++,t=s(o,t);continue}if("?"!==o[t+1])break;if(t=n(o,++t),t.err)return t}else if("&"===o[t]){const e=l(o,t);if(-1==e)return f("InvalidChar","char '&' is not expected.",d(o,t));t=e}else if(!0===p&&!r(o[t]))return f("InvalidXml","Extra text at the end",d(o,t));"<"===o[t]&&t--}}}var m;return h?1==c.length?f("InvalidTag","Unclosed tag '"+c[0].tagName+"'.",d(o,c[0].tagStartPos)):!(c.length>0)||f("InvalidXml","Invalid '"+JSON.stringify(c.map((e=>e.tagName)),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):f("InvalidXml","Start tag expected.",1)};const o='"',i="'";function a(e,t){let r="",n="",s=!1;for(;t<e.length;t++){if(e[t]===o||e[t]===i)""===n?n=e[t]:n!==e[t]||(n="");else if(">"===e[t]&&""===n){s=!0;break}r+=e[t]}return""===n&&{value:r,index:t,tagClosed:s}}const c=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function u(t,r){const n=e.getAllMatches(t,c),s={};for(let e=0;e<n.length;e++){if(0===n[e][1].length)return f("InvalidAttr","Attribute '"+n[e][2]+"' has no space in starting.",p(n[e]));if(void 0!==n[e][3]&&void 0===n[e][4])return f("InvalidAttr","Attribute '"+n[e][2]+"' is without value.",p(n[e]));if(void 0===n[e][3]&&!r.allowBooleanAttributes)return f("InvalidAttr","boolean attribute '"+n[e][2]+"' is not allowed.",p(n[e]));const t=n[e][2];if(!h(t))return f("InvalidAttr","Attribute '"+t+"' is an invalid name.",p(n[e]));if(s.hasOwnProperty(t))return f("InvalidAttr","Attribute '"+t+"' is repeated.",p(n[e]));s[t]=1}return!0}function l(e,t){if(";"===e[++t])return-1;if("#"===e[t])return function(e,t){let r=/\d/;for("x"===e[t]&&(t++,r=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(r))break}return-1}(e,++t);let r=0;for(;t<e.length;t++,r++)if(!(e[t].match(/\w/)&&r<20)){if(";"===e[t])break;return-1}return t}function f(e,t,r){return{err:{code:e,msg:t,line:r.line||r,col:r.col}}}function h(t){return e.isName(t)}function d(e,t){const r=e.substring(0,t).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function p(e){return e.startIndex+e[1].length}return To}var ko,Lo,_o,jo,Mo,Do,Uo,Bo,Fo,Vo={};function zo(){if(_o)return Lo;_o=1;return Lo=class{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){"__proto__"===e&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e){"__proto__"===e.tagname&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}}function Ko(){if(Uo)return Do;Uo=1;const e=/^[-+]?0x[a-fA-F0-9]+$/,t=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,r={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};return Do=function(n,s={}){if(s=Object.assign({},r,s),!n||"string"!=typeof n)return n;let o=n.trim();if(void 0!==s.skipLike&&s.skipLike.test(o))return n;if("0"===n)return 0;if(s.hex&&e.test(o))return function(e,t){if(parseInt)return parseInt(e,t);if(Number.parseInt)return Number.parseInt(e,t);if(window&&window.parseInt)return window.parseInt(e,t);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}(o,16);if(-1!==o.search(/[eE]/)){const e=o.match(/^([-\+])?(0*)([0-9]*(\.[0-9]*)?[eE][-\+]?[0-9]+)$/);if(e){if(s.leadingZeros)o=(e[1]||"")+e[3];else if("0"!==e[2]||"."!==e[3][0])return n;return s.eNotation?Number(o):n}return n}{const e=t.exec(o);if(e){const t=e[1],r=e[2];let i=function(e){if(e&&-1!==e.indexOf("."))return"."===(e=e.replace(/0+$/,""))?e="0":"."===e[0]?e="0"+e:"."===e[e.length-1]&&(e=e.substr(0,e.length-1)),e;return e}(e[3]);if(!s.leadingZeros&&r.length>0&&t&&"."!==o[2])return n;if(!s.leadingZeros&&r.length>0&&!t&&"."!==o[1])return n;if(s.leadingZeros&&r===n)return 0;{const e=Number(o),a=""+e;return-1!==a.search(/[eE]/)?s.eNotation?e:n:-1!==o.indexOf(".")?"0"===a&&""===i||a===i||t&&a==="-"+i?e:n:r?i===a||t+i===a?e:n:o===a||o===t+a?e:n}}return n}},Do}function qo(){if(Fo)return Bo;Fo=1;const e=Ro(),t=zo(),r=function(){if(Mo)return jo;Mo=1;const e=Ro();function t(e,t){let r="";for(;t<e.length&&"'"!==e[t]&&'"'!==e[t];t++)r+=e[t];if(r=r.trim(),-1!==r.indexOf(" "))throw new Error("External entites are not supported");const n=e[t++];let s="";for(;t<e.length&&e[t]!==n;t++)s+=e[t];return[r,s,t]}function r(e,t){return"!"===e[t+1]&&"-"===e[t+2]&&"-"===e[t+3]}function n(e,t){return"!"===e[t+1]&&"E"===e[t+2]&&"N"===e[t+3]&&"T"===e[t+4]&&"I"===e[t+5]&&"T"===e[t+6]&&"Y"===e[t+7]}function s(e,t){return"!"===e[t+1]&&"E"===e[t+2]&&"L"===e[t+3]&&"E"===e[t+4]&&"M"===e[t+5]&&"E"===e[t+6]&&"N"===e[t+7]&&"T"===e[t+8]}function o(e,t){return"!"===e[t+1]&&"A"===e[t+2]&&"T"===e[t+3]&&"T"===e[t+4]&&"L"===e[t+5]&&"I"===e[t+6]&&"S"===e[t+7]&&"T"===e[t+8]}function i(e,t){return"!"===e[t+1]&&"N"===e[t+2]&&"O"===e[t+3]&&"T"===e[t+4]&&"A"===e[t+5]&&"T"===e[t+6]&&"I"===e[t+7]&&"O"===e[t+8]&&"N"===e[t+9]}function a(t){if(e.isName(t))return t;throw new Error(`Invalid entity name ${t}`)}return jo=function(e,c){const u={};if("O"!==e[c+3]||"C"!==e[c+4]||"T"!==e[c+5]||"Y"!==e[c+6]||"P"!==e[c+7]||"E"!==e[c+8])throw new Error("Invalid Tag instead of DOCTYPE");{c+=9;let l=1,f=!1,h=!1,d="";for(;c<e.length;c++)if("<"!==e[c]||h)if(">"===e[c]){if(h?"-"===e[c-1]&&"-"===e[c-2]&&(h=!1,l--):l--,0===l)break}else"["===e[c]?f=!0:d+=e[c];else{if(f&&n(e,c))c+=7,[entityName,val,c]=t(e,c+1),-1===val.indexOf("&")&&(u[a(entityName)]={regx:RegExp(`&${entityName};`,"g"),val:val});else if(f&&s(e,c))c+=8;else if(f&&o(e,c))c+=8;else if(f&&i(e,c))c+=9;else{if(!r)throw new Error("Invalid DOCTYPE");h=!0}l++,d=""}if(0!==l)throw new Error("Unclosed DOCTYPE")}return{entities:u,i:c}}}(),n=Ko();function s(e){const t=Object.keys(e);for(let r=0;r<t.length;r++){const n=t[r];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:e[n]}}}function o(e,t,r,n,s,o,i){if(void 0!==e&&(this.options.trimValues&&!n&&(e=e.trim()),e.length>0)){i||(e=this.replaceEntitiesValue(e));const n=this.options.tagValueProcessor(t,e,r,s,o);if(null==n)return e;if(typeof n!=typeof e||n!==e)return n;if(this.options.trimValues)return y(e,this.options.parseTagValue,this.options.numberParseOptions);return e.trim()===e?y(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function i(e){if(this.options.removeNSPrefix){const t=e.split(":"),r="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=r+t[1])}return e}const a=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function c(t,r,n){if(!this.options.ignoreAttributes&&"string"==typeof t){const n=e.getAllMatches(t,a),s=n.length,o={};for(let e=0;e<s;e++){const t=this.resolveNameSpace(n[e][1]);let s=n[e][4],i=this.options.attributeNamePrefix+t;if(t.length)if(this.options.transformAttributeName&&(i=this.options.transformAttributeName(i)),"__proto__"===i&&(i="#__proto__"),void 0!==s){this.options.trimValues&&(s=s.trim()),s=this.replaceEntitiesValue(s);const e=this.options.attributeValueProcessor(t,s,r);o[i]=null==e?s:typeof e!=typeof s||e!==s?e:y(s,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(o[i]=!0)}if(!Object.keys(o).length)return;if(this.options.attributesGroupName){const e={};return e[this.options.attributesGroupName]=o,e}return o}}const u=function(e){e=e.replace(/\r\n?/g,"\n");const n=new t("!xml");let s=n,o="",i="";for(let a=0;a<e.length;a++){if("<"===e[a])if("/"===e[a+1]){const t=p(e,">",a,"Closing Tag is not closed.");let r=e.substring(a+2,t).trim();if(this.options.removeNSPrefix){const e=r.indexOf(":");-1!==e&&(r=r.substr(e+1))}this.options.transformTagName&&(r=this.options.transformTagName(r)),s&&(o=this.saveTextToParentTag(o,s,i));const n=i.substring(i.lastIndexOf(".")+1);if(r&&-1!==this.options.unpairedTags.indexOf(r))throw new Error(`Unpaired tag can not be used as closing tag: </${r}>`);let c=0;n&&-1!==this.options.unpairedTags.indexOf(n)?(c=i.lastIndexOf(".",i.lastIndexOf(".")-1),this.tagsNodeStack.pop()):c=i.lastIndexOf("."),i=i.substring(0,c),s=this.tagsNodeStack.pop(),o="",a=t}else if("?"===e[a+1]){let r=m(e,a,!1,"?>");if(!r)throw new Error("Pi Tag is not closed.");if(o=this.saveTextToParentTag(o,s,i),this.options.ignoreDeclaration&&"?xml"===r.tagName||this.options.ignorePiTags);else{const e=new t(r.tagName);e.add(this.options.textNodeName,""),r.tagName!==r.tagExp&&r.attrExpPresent&&(e[":@"]=this.buildAttributesMap(r.tagExp,i,r.tagName)),this.addChild(s,e,i)}a=r.closeIndex+1}else if("!--"===e.substr(a+1,3)){const t=p(e,"--\x3e",a+4,"Comment is not closed.");if(this.options.commentPropName){const r=e.substring(a+4,t-2);o=this.saveTextToParentTag(o,s,i),s.add(this.options.commentPropName,[{[this.options.textNodeName]:r}])}a=t}else if("!D"===e.substr(a+1,2)){const t=r(e,a);this.docTypeEntities=t.entities,a=t.i}else if("!["===e.substr(a+1,2)){const t=p(e,"]]>",a,"CDATA is not closed.")-2,r=e.substring(a+9,t);o=this.saveTextToParentTag(o,s,i);let n=this.parseTextData(r,s.tagname,i,!0,!1,!0,!0);null==n&&(n=""),this.options.cdataPropName?s.add(this.options.cdataPropName,[{[this.options.textNodeName]:r}]):s.add(this.options.textNodeName,n),a=t+2}else{let r=m(e,a,this.options.removeNSPrefix),c=r.tagName;const u=r.rawTagName;let l=r.tagExp,f=r.attrExpPresent,h=r.closeIndex;this.options.transformTagName&&(c=this.options.transformTagName(c)),s&&o&&"!xml"!==s.tagname&&(o=this.saveTextToParentTag(o,s,i,!1));const d=s;if(d&&-1!==this.options.unpairedTags.indexOf(d.tagname)&&(s=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf("."))),c!==n.tagname&&(i+=i?"."+c:c),this.isItStopNode(this.options.stopNodes,i,c)){let n="";if(l.length>0&&l.lastIndexOf("/")===l.length-1)"/"===c[c.length-1]?(c=c.substr(0,c.length-1),i=i.substr(0,i.length-1),l=c):l=l.substr(0,l.length-1),a=r.closeIndex;else if(-1!==this.options.unpairedTags.indexOf(c))a=r.closeIndex;else{const t=this.readStopNodeData(e,u,h+1);if(!t)throw new Error(`Unexpected end of ${u}`);a=t.i,n=t.tagContent}const o=new t(c);c!==l&&f&&(o[":@"]=this.buildAttributesMap(l,i,c)),n&&(n=this.parseTextData(n,c,i,!0,f,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),o.add(this.options.textNodeName,n),this.addChild(s,o,i)}else{if(l.length>0&&l.lastIndexOf("/")===l.length-1){"/"===c[c.length-1]?(c=c.substr(0,c.length-1),i=i.substr(0,i.length-1),l=c):l=l.substr(0,l.length-1),this.options.transformTagName&&(c=this.options.transformTagName(c));const e=new t(c);c!==l&&f&&(e[":@"]=this.buildAttributesMap(l,i,c)),this.addChild(s,e,i),i=i.substr(0,i.lastIndexOf("."))}else{const e=new t(c);this.tagsNodeStack.push(s),c!==l&&f&&(e[":@"]=this.buildAttributesMap(l,i,c)),this.addChild(s,e,i),s=e}o="",a=h}}else o+=e[a]}return n.child};function l(e,t,r){const n=this.options.updateTag(t.tagname,r,t[":@"]);!1===n||("string"==typeof n?(t.tagname=n,e.addChild(t)):e.addChild(t))}const f=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){const r=this.docTypeEntities[t];e=e.replace(r.regx,r.val)}for(let t in this.lastEntities){const r=this.lastEntities[t];e=e.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const r=this.htmlEntities[t];e=e.replace(r.regex,r.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function h(e,t,r,n){return e&&(void 0===n&&(n=0===Object.keys(t.child).length),void 0!==(e=this.parseTextData(e,t.tagname,r,!1,!!t[":@"]&&0!==Object.keys(t[":@"]).length,n))&&""!==e&&t.add(this.options.textNodeName,e),e=""),e}function d(e,t,r){const n="*."+r;for(const r in e){const s=e[r];if(n===s||t===s)return!0}return!1}function p(e,t,r,n){const s=e.indexOf(t,r);if(-1===s)throw new Error(n);return s+t.length-1}function m(e,t,r,n=">"){const s=function(e,t,r=">"){let n,s="";for(let o=t;o<e.length;o++){let t=e[o];if(n)t===n&&(n="");else if('"'===t||"'"===t)n=t;else if(t===r[0]){if(!r[1])return{data:s,index:o};if(e[o+1]===r[1])return{data:s,index:o}}else"\t"===t&&(t=" ");s+=t}}(e,t+1,n);if(!s)return;let o=s.data;const i=s.index,a=o.search(/\s/);let c=o,u=!0;-1!==a&&(c=o.substring(0,a),o=o.substring(a+1).trimStart());const l=c;if(r){const e=c.indexOf(":");-1!==e&&(c=c.substr(e+1),u=c!==s.data.substr(e+1))}return{tagName:c,tagExp:o,closeIndex:i,attrExpPresent:u,rawTagName:l}}function g(e,t,r){const n=r;let s=1;for(;r<e.length;r++)if("<"===e[r])if("/"===e[r+1]){const o=p(e,">",r,`${t} is not closed`);if(e.substring(r+2,o).trim()===t&&(s--,0===s))return{tagContent:e.substring(n,r),i:o};r=o}else if("?"===e[r+1]){r=p(e,"?>",r+1,"StopNode is not closed.")}else if("!--"===e.substr(r+1,3)){r=p(e,"--\x3e",r+3,"StopNode is not closed.")}else if("!["===e.substr(r+1,2)){r=p(e,"]]>",r,"StopNode is not closed.")-2}else{const n=m(e,r,">");if(n){(n&&n.tagName)===t&&"/"!==n.tagExp[n.tagExp.length-1]&&s++,r=n.closeIndex}}}function y(t,r,s){if(r&&"string"==typeof t){const e=t.trim();return"true"===e||"false"!==e&&n(t,s)}return e.isExist(t)?t:""}return Bo=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¬¢"},pound:{regex:/&(pound|#163);/g,val:"¬£"},yen:{regex:/&(yen|#165);/g,val:"¬•"},euro:{regex:/&(euro|#8364);/g,val:"‚Ç¨"},copyright:{regex:/&(copy|#169);/g,val:"¬©"},reg:{regex:/&(reg|#174);/g,val:"¬Æ"},inr:{regex:/&(inr|#8377);/g,val:"‚Çπ"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,t)=>String.fromCharCode(Number.parseInt(t,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,t)=>String.fromCharCode(Number.parseInt(t,16))}},this.addExternalEntities=s,this.parseXml=u,this.parseTextData=o,this.resolveNameSpace=i,this.buildAttributesMap=c,this.isItStopNode=d,this.replaceEntitiesValue=f,this.readStopNodeData=g,this.saveTextToParentTag=h,this.addChild=l}}}var Ho,Go,Wo,Xo,Yo,Jo,Zo,Qo,ei,ti={};function ri(){if(Ho)return ti;function e(s,o,i){let a;const c={};for(let u=0;u<s.length;u++){const l=s[u],f=t(l);let h="";if(h=void 0===i?f:i+"."+f,f===o.textNodeName)void 0===a?a=l[f]:a+=""+l[f];else{if(void 0===f)continue;if(l[f]){let t=e(l[f],o,h);const s=n(t,o);l[":@"]?r(t,l[":@"],h,o):1!==Object.keys(t).length||void 0===t[o.textNodeName]||o.alwaysCreateTextNode?0===Object.keys(t).length&&(o.alwaysCreateTextNode?t[o.textNodeName]="":t=""):t=t[o.textNodeName],void 0!==c[f]&&c.hasOwnProperty(f)?(Array.isArray(c[f])||(c[f]=[c[f]]),c[f].push(t)):o.isArray(f,h,s)?c[f]=[t]:c[f]=t}}}return"string"==typeof a?a.length>0&&(c[o.textNodeName]=a):void 0!==a&&(c[o.textNodeName]=a),c}function t(e){const t=Object.keys(e);for(let e=0;e<t.length;e++){const r=t[e];if(":@"!==r)return r}}function r(e,t,r,n){if(t){const s=Object.keys(t),o=s.length;for(let i=0;i<o;i++){const o=s[i];n.isArray(o,r+"."+o,!0,!0)?e[o]=[t[o]]:e[o]=t[o]}}}function n(e,t){const{textNodeName:r}=t,n=Object.keys(e).length;return 0===n||!(1!==n||!e[r]&&"boolean"!=typeof e[r]&&0!==e[r])}return Ho=1,ti.prettify=function(t,r){return e(t,r)},ti}function ni(){if(Wo)return Go;Wo=1;const{buildOptions:e}=function(){if(ko)return Vo;ko=1;const e={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,r){return e}};return Vo.buildOptions=function(t){return Object.assign({},e,t)},Vo.defaultOptions=e,Vo}(),t=qo(),{prettify:r}=ri(),n=Po();return Go=class{constructor(t){this.externalEntities={},this.options=e(t)}parse(e,s){if("string"==typeof e);else{if(!e.toString)throw new Error("XML data is accepted in String or Bytes[] form.");e=e.toString()}if(s){!0===s&&(s={});const t=n.validate(e,s);if(!0!==t)throw Error(`${t.err.msg}:${t.err.line}:${t.err.col}`)}const o=new t(this.options);o.addExternalEntities(this.externalEntities);const i=o.parseXml(e);return this.options.preserveOrder||void 0===i?i:r(i,this.options)}addEntity(e,t){if(-1!==t.indexOf("&"))throw new Error("Entity value can't have '&'");if(-1!==e.indexOf("&")||-1!==e.indexOf(";"))throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if("&"===t)throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}}}function si(){if(Yo)return Xo;Yo=1;function e(o,i,a,c){let u="",l=!1;for(let f=0;f<o.length;f++){const h=o[f],d=t(h);if(void 0===d)continue;let p="";if(p=0===a.length?d:`${a}.${d}`,d===i.textNodeName){let e=h[d];n(p,i)||(e=i.tagValueProcessor(d,e),e=s(e,i)),l&&(u+=c),u+=e,l=!1;continue}if(d===i.cdataPropName){l&&(u+=c),u+=`<![CDATA[${h[d][0][i.textNodeName]}]]>`,l=!1;continue}if(d===i.commentPropName){u+=c+`\x3c!--${h[d][0][i.textNodeName]}--\x3e`,l=!0;continue}if("?"===d[0]){const e=r(h[":@"],i),t="?xml"===d?"":c;let n=h[d][0][i.textNodeName];n=0!==n.length?" "+n:"",u+=t+`<${d}${n}${e}?>`,l=!0;continue}let m=c;""!==m&&(m+=i.indentBy);const g=c+`<${d}${r(h[":@"],i)}`,y=e(h[d],i,p,m);-1!==i.unpairedTags.indexOf(d)?i.suppressUnpairedNode?u+=g+">":u+=g+"/>":y&&0!==y.length||!i.suppressEmptyNode?y&&y.endsWith(">")?u+=g+`>${y}${c}</${d}>`:(u+=g+">",y&&""!==c&&(y.includes("/>")||y.includes("</"))?u+=c+i.indentBy+y+c:u+=y,u+=`</${d}>`):u+=g+"/>",l=!0}return u}function t(e){const t=Object.keys(e);for(let r=0;r<t.length;r++){const n=t[r];if(e.hasOwnProperty(n)&&":@"!==n)return n}}function r(e,t){let r="";if(e&&!t.ignoreAttributes)for(let n in e){if(!e.hasOwnProperty(n))continue;let o=t.attributeValueProcessor(n,e[n]);o=s(o,t),!0===o&&t.suppressBooleanAttributes?r+=` ${n.substr(t.attributeNamePrefix.length)}`:r+=` ${n.substr(t.attributeNamePrefix.length)}="${o}"`}return r}function n(e,t){let r=(e=e.substr(0,e.length-t.textNodeName.length-1)).substr(e.lastIndexOf(".")+1);for(let n in t.stopNodes)if(t.stopNodes[n]===e||t.stopNodes[n]==="*."+r)return!0;return!1}function s(e,t){if(e&&e.length>0&&t.processEntities)for(let r=0;r<t.entities.length;r++){const n=t.entities[r];e=e.replace(n.regex,n.val)}return e}return Xo=function(t,r){let n="";return r.format&&r.indentBy.length>0&&(n="\n"),e(t,r,"",n)}}var oi=function(){if(ei)return Qo;ei=1;const e=Po(),t=ni(),r=function(){if(Zo)return Jo;Zo=1;const e=si(),t={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function r(e){this.options=Object.assign({},t,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=o),this.processTextOrObjNode=n,this.options.format?(this.indentate=s,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}function n(e,t,r){const n=this.j2x(e,r+1);return void 0!==e[this.options.textNodeName]&&1===Object.keys(e).length?this.buildTextValNode(e[this.options.textNodeName],t,n.attrStr,r):this.buildObjectNode(n.val,t,n.attrStr,r)}function s(e){return this.options.indentBy.repeat(e)}function o(e){return!(!e.startsWith(this.options.attributeNamePrefix)||e===this.options.textNodeName)&&e.substr(this.attrPrefixLen)}return r.prototype.build=function(t){return this.options.preserveOrder?e(t,this.options):(Array.isArray(t)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(t={[this.options.arrayNodeName]:t}),this.j2x(t,0).val)},r.prototype.j2x=function(e,t){let r="",n="";for(let s in e)if(Object.prototype.hasOwnProperty.call(e,s))if(void 0===e[s])this.isAttribute(s)&&(n+="");else if(null===e[s])this.isAttribute(s)?n+="":"?"===s[0]?n+=this.indentate(t)+"<"+s+"?"+this.tagEndChar:n+=this.indentate(t)+"<"+s+"/"+this.tagEndChar;else if(e[s]instanceof Date)n+=this.buildTextValNode(e[s],s,"",t);else if("object"!=typeof e[s]){const o=this.isAttribute(s);if(o)r+=this.buildAttrPairStr(o,""+e[s]);else if(s===this.options.textNodeName){let t=this.options.tagValueProcessor(s,""+e[s]);n+=this.replaceEntitiesValue(t)}else n+=this.buildTextValNode(e[s],s,"",t)}else if(Array.isArray(e[s])){const r=e[s].length;let o="",i="";for(let a=0;a<r;a++){const r=e[s][a];if(void 0===r);else if(null===r)"?"===s[0]?n+=this.indentate(t)+"<"+s+"?"+this.tagEndChar:n+=this.indentate(t)+"<"+s+"/"+this.tagEndChar;else if("object"==typeof r)if(this.options.oneListGroup){const e=this.j2x(r,t+1);o+=e.val,this.options.attributesGroupName&&r.hasOwnProperty(this.options.attributesGroupName)&&(i+=e.attrStr)}else o+=this.processTextOrObjNode(r,s,t);else if(this.options.oneListGroup){let e=this.options.tagValueProcessor(s,r);e=this.replaceEntitiesValue(e),o+=e}else o+=this.buildTextValNode(r,s,"",t)}this.options.oneListGroup&&(o=this.buildObjectNode(o,s,i,t)),n+=o}else if(this.options.attributesGroupName&&s===this.options.attributesGroupName){const t=Object.keys(e[s]),n=t.length;for(let o=0;o<n;o++)r+=this.buildAttrPairStr(t[o],""+e[s][t[o]])}else n+=this.processTextOrObjNode(e[s],s,t);return{attrStr:r,val:n}},r.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&"true"===t?" "+e:" "+e+'="'+t+'"'},r.prototype.buildObjectNode=function(e,t,r,n){if(""===e)return"?"===t[0]?this.indentate(n)+"<"+t+r+"?"+this.tagEndChar:this.indentate(n)+"<"+t+r+this.closeTag(t)+this.tagEndChar;{let s="</"+t+this.tagEndChar,o="";return"?"===t[0]&&(o="?",s=""),!r&&""!==r||-1!==e.indexOf("<")?!1!==this.options.commentPropName&&t===this.options.commentPropName&&0===o.length?this.indentate(n)+`\x3c!--${e}--\x3e`+this.newLine:this.indentate(n)+"<"+t+r+o+this.tagEndChar+e+this.indentate(n)+s:this.indentate(n)+"<"+t+r+o+">"+e+s}},r.prototype.closeTag=function(e){let t="";return-1!==this.options.unpairedTags.indexOf(e)?this.options.suppressUnpairedNode||(t="/"):t=this.options.suppressEmptyNode?"/":`></${e}`,t},r.prototype.buildTextValNode=function(e,t,r,n){if(!1!==this.options.cdataPropName&&t===this.options.cdataPropName)return this.indentate(n)+`<![CDATA[${e}]]>`+this.newLine;if(!1!==this.options.commentPropName&&t===this.options.commentPropName)return this.indentate(n)+`\x3c!--${e}--\x3e`+this.newLine;if("?"===t[0])return this.indentate(n)+"<"+t+r+"?"+this.tagEndChar;{let s=this.options.tagValueProcessor(t,e);return s=this.replaceEntitiesValue(s),""===s?this.indentate(n)+"<"+t+r+this.closeTag(t)+this.tagEndChar:this.indentate(n)+"<"+t+r+">"+s+"</"+t+this.tagEndChar}},r.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){const r=this.options.entities[t];e=e.replace(r.regex,r.val)}return e},Jo=r}();return Qo={XMLParser:t,XMLValidator:e,XMLBuilder:r}}();const ii=(e,t)=>((e,t)=>Es(e,t).then((e=>t.utf8Encoder(e))))(e,t).then((e=>{if(e.length){const t=new oi.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(e,t)=>""===t.trim()&&t.includes("\n")?"":void 0});let r;t.addEntity("#xD","\r"),t.addEntity("#10","\n");try{r=t.parse(e,!0)}catch(t){throw t&&"object"==typeof t&&Object.defineProperty(t,"$responseBodyText",{value:e}),t}const n="#text",s=Object.keys(r)[0],o=r[s];return o[n]&&(o[s]=o[n],delete o[n]),vo(o)}return{}})),ai=async(e,t)=>{const r=await ii(e,t);return r.Error&&(r.Error.message=r.Error.message??r.Error.Message),r},ci=[Fn.CRC32,Fn.CRC32C,Fn.CRC64NVME,Fn.SHA1,Fn.SHA256],ui=[Fn.SHA256,Fn.SHA1,Fn.CRC32,Fn.CRC32C,Fn.CRC64NVME],li=e=>e===Fn.MD5?"content-md5":`x-amz-checksum-${e.toLowerCase()}`,fi=e=>void 0!==e&&"string"!=typeof e&&!ArrayBuffer.isView(e)&&!Xn(e);function hi(e,t,r,n){return new(r||(r=Promise))((function(s,o){function i(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}c((n=n.apply(e,t||[])).next())}))}function di(e,t){var r,n,s,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(s=2&a[0]?n.return:a[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,a[1])).done)return s;switch(n=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){o.label=a[1];break}if(6===a[0]&&o.label<s[1]){o.label=s[1],s=a;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(a);break}s[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function pi(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}"function"==typeof SuppressedError&&SuppressedError;var mi="undefined"!=typeof Buffer&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:e=>{const t=((e,t)=>{if("string"!=typeof e)throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return o.from(e,t)})(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)};function gi(e){return e instanceof Uint8Array?e:"string"==typeof e?mi(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function yi(e){return"string"==typeof e?0===e.length:0===e.byteLength}function Ei(e){return new Uint8Array([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])}function bi(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),r=0;r<e.length;)t[r]=e[r],r+=1;return t}return Uint32Array.from(e)}var wi=function(){function e(){this.crc32c=new vi}return e.prototype.update=function(e){yi(e)||this.crc32c.update(gi(e))},e.prototype.digest=function(){return hi(this,void 0,void 0,(function(){return di(this,(function(e){return[2,Ei(this.crc32c.digest())]}))}))},e.prototype.reset=function(){this.crc32c=new vi},e}(),vi=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var t,r;try{for(var n=pi(e),s=n.next();!s.done;s=n.next()){var o=s.value;this.checksum=this.checksum>>>8^Si[255&(this.checksum^o)]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}(),Si=bi([0,4067132163,3778769143,324072436,3348797215,904991772,648144872,3570033899,2329499855,2024987596,1809983544,2575936315,1296289744,3207089363,2893594407,1578318884,274646895,3795141740,4049975192,51262619,3619967088,632279923,922689671,3298075524,2592579488,1760304291,2075979607,2312596564,1562183871,2943781820,3156637768,1313733451,549293790,3537243613,3246849577,871202090,3878099393,357341890,102525238,4101499445,2858735121,1477399826,1264559846,3107202533,1845379342,2677391885,2361733625,2125378298,820201905,3263744690,3520608582,598981189,4151959214,85089709,373468761,3827903834,3124367742,1213305469,1526817161,2842354314,2107672161,2412447074,2627466902,1861252501,1098587580,3004210879,2688576843,1378610760,2262928035,1955203488,1742404180,2511436119,3416409459,969524848,714683780,3639785095,205050476,4266873199,3976438427,526918040,1361435347,2739821008,2954799652,1114974503,2529119692,1691668175,2005155131,2247081528,3690758684,697762079,986182379,3366744552,476452099,3993867776,4250756596,255256311,1640403810,2477592673,2164122517,1922457750,2791048317,1412925310,1197962378,3037525897,3944729517,427051182,170179418,4165941337,746937522,3740196785,3451792453,1070968646,1905808397,2213795598,2426610938,1657317369,3053634322,1147748369,1463399397,2773627110,4215344322,153784257,444234805,3893493558,1021025245,3467647198,3722505002,797665321,2197175160,1889384571,1674398607,2443626636,1164749927,3070701412,2757221520,1446797203,137323447,4198817972,3910406976,461344835,3484808360,1037989803,781091935,3705997148,2460548119,1623424788,1939049696,2180517859,1429367560,2807687179,3020495871,1180866812,410100952,3927582683,4182430767,186734380,3756733383,763408580,1053836080,3434856499,2722870694,1344288421,1131464017,2971354706,1708204729,2545590714,2229949006,1988219213,680717673,3673779818,3383336350,1002577565,4010310262,493091189,238226049,4233660802,2987750089,1082061258,1395524158,2705686845,1972364758,2279892693,2494862625,1725896226,952904198,3399985413,3656866545,731699698,4283874585,222117402,510512622,3959836397,3280807620,837199303,582374963,3504198960,68661723,4135334616,3844915500,390545967,1230274059,3141532936,2825850620,1510247935,2395924756,2091215383,1878366691,2644384480,3553878443,565732008,854102364,3229815391,340358836,3861050807,4117890627,119113024,1493875044,2875275879,3090270611,1247431312,2660249211,1828433272,2141937292,2378227087,3811616794,291187481,34330861,4032846830,615137029,3603020806,3314634738,939183345,1776939221,2609017814,2295496738,2058945313,2926798794,1545135305,1330124605,3173225534,4084100981,17165430,307568514,3762199681,888469610,3332340585,3587147933,665062302,2042050490,2346497209,2559330125,1793573966,3190661285,1279665062,1595330642,2910671697]),Ni=function(){function e(){this.crc32=new Ii}return e.prototype.update=function(e){yi(e)||this.crc32.update(gi(e))},e.prototype.digest=function(){return hi(this,void 0,void 0,(function(){return di(this,(function(e){return[2,Ei(this.crc32.digest())]}))}))},e.prototype.reset=function(){this.crc32=new Ii},e}(),Ii=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var t,r;try{for(var n=pi(e),s=n.next();!s.done;s=n.next()){var o=s.value;this.checksum=this.checksum>>>8^xi[255&(this.checksum^o)]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}(),xi=bi([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);class Ai{checksum=0;update(e){this.checksum=d.crc32(e,this.checksum)}async digest(){return Ei(this.checksum)}reset(){this.checksum=0}}const $i=(e,t)=>{switch(e){case Fn.MD5:return t.md5;case Fn.CRC32:return void 0===d.crc32?Ni:Ai;case Fn.CRC32C:return wi;case Fn.CRC64NVME:throw new Error('Please check whether you have installed the "@aws-sdk/crc64-nvme-crt" package explicitly. \nYou must also register the package by calling [require("@aws-sdk/crc64-nvme-crt");] or an ESM equivalent such as [import "@aws-sdk/crc64-nvme-crt";]. \nFor more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt');case Fn.SHA1:return t.sha1;case Fn.SHA256:return t.sha256;default:throw new Error(`Unsupported checksum algorithm: ${e}`)}},Ci=(e,t)=>{const r=new e;var n;return r.update("string"==typeof(n=t||"")?Qn(n):ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(n)),r.digest()},Ti={name:"flexibleChecksumsMiddleware",step:"build",tags:["BODY_CHECKSUM"],override:!0},Oi=(e,t)=>(r,n)=>async s=>{if(!_n.isInstance(s.request))return r(s);if(((e,t)=>{const r=e.toLowerCase();for(const e of Object.keys(t))if(e.toLowerCase().startsWith(r))return!0;return!1})("x-amz-checksum-",s.request.headers))return r(s);const{request:o,input:i}=s,{body:a,headers:c}=o,{base64Encoder:u,streamHasher:l}=e,{requestChecksumRequired:f,requestAlgorithmMember:h}=t,d=await e.requestChecksumCalculation(),p=h?.name,m=h?.httpHeader;p&&!i[p]&&(d===Mn||f)&&(i[p]=zn,m&&(c[m]=zn));const g=((e,{requestChecksumRequired:t,requestAlgorithmMember:r,requestChecksumCalculation:n})=>{if(!r)return n===Mn||t?zn:void 0;if(!e[r])return;const s=e[r];if(!ci.includes(s))throw new Error(`The checksum algorithm "${s}" is not supported by the client. Select one of ${ci}.`);return s})(i,{requestChecksumRequired:f,requestAlgorithmMember:h?.name,requestChecksumCalculation:d});let y=a,E=c;if(g){switch(g){case Fn.CRC32:qn(n,"FLEXIBLE_CHECKSUMS_REQ_CRC32","U");break;case Fn.CRC32C:qn(n,"FLEXIBLE_CHECKSUMS_REQ_CRC32C","V");break;case Fn.CRC64NVME:qn(n,"FLEXIBLE_CHECKSUMS_REQ_CRC64","W");break;case Fn.SHA1:qn(n,"FLEXIBLE_CHECKSUMS_REQ_SHA1","X");break;case Fn.SHA256:qn(n,"FLEXIBLE_CHECKSUMS_REQ_SHA256","Y")}const t=li(g),r=$i(g,e);if(fi(a)){const{getAwsChunkedEncodingStream:s,bodyLengthChecker:o}=e;y=s("number"==typeof e.requestStreamBufferSize&&e.requestStreamBufferSize>=8192?ps(a,e.requestStreamBufferSize,n.logger):a,{base64Encoder:u,bodyLengthChecker:o,checksumLocationName:t,checksumAlgorithmFn:r,streamHasher:l}),E={...c,"content-encoding":c["content-encoding"]?`${c["content-encoding"]},aws-chunked`:"aws-chunked","transfer-encoding":"chunked","x-amz-decoded-content-length":c["content-length"],"x-amz-content-sha256":"STREAMING-UNSIGNED-PAYLOAD-TRAILER","x-amz-trailer":t},delete E["content-length"]}else if(!((e,t)=>{const r=e.toLowerCase();for(const e of Object.keys(t))if(r===e.toLowerCase())return!0;return!1})(t,c)){const e=await Ci(r,a);E={...c,[t]:u(e)}}}return await r({...s,request:{...o,headers:E,body:y}})},Ri={name:"flexibleChecksumsInputMiddleware",toMiddleware:"serializerMiddleware",relation:"before",tags:["BODY_CHECKSUM"],override:!0},Pi=(e=[])=>{const t=[];for(const r of ui)e.includes(r)&&ci.includes(r)&&t.push(r);return t},ki=async(e,{checksumAlgorithmFn:t,base64Encoder:r})=>r(await Ci(t,e)),Li={name:"flexibleChecksumsResponseMiddleware",toMiddleware:"deserializerMiddleware",relation:"after",tags:["BODY_CHECKSUM"],override:!0},_i=(e,t)=>(r,n)=>async s=>{if(!_n.isInstance(s.request))return r(s);const o=s.input,i=await r(s),a=i.response,{requestValidationModeMember:c,responseAlgorithms:u}=t;if(c&&"ENABLED"===o[c]){const{clientName:t,commandName:r}=n;if("S3Client"===t&&"GetObjectCommand"===r&&Pi(u).every((e=>{const t=li(e),r=a.headers[t];return!r||(e=>{const t=e.lastIndexOf("-");if(-1!==t){const r=e.slice(t+1);if(!r.startsWith("0")){const e=parseInt(r,10);if(!isNaN(e)&&e>=1&&e<=1e4)return!0}}return!1})(r)})))return i;await(async(e,{config:t,responseAlgorithms:r,logger:n})=>{const s=Pi(r),{body:o,headers:i}=e;for(const r of s){const s=li(r),a=i[s];if(a){let i;try{i=$i(r,t)}catch(e){if(r===Fn.CRC64NVME){n?.warn(`Skipping ${Fn.CRC64NVME} checksum validation: ${e.message}`);continue}throw e}const{base64Encoder:c}=t;if(fi(o))return void(e.body=cs({expectedChecksum:a,checksumSourceLocation:s,checksum:new i,source:o,base64Encoder:c}));const u=await ki(o,{checksumAlgorithmFn:i,base64Encoder:c});if(u===a)break;throw new Error(`Checksum mismatch: expected "${u}" but received "${a}" in response header "${s}".`)}}})(a,{config:e,responseAlgorithms:u,logger:n.logger})}return i},ji=(e,t)=>({applyToStack:r=>{r.add(Oi(e,t),Ti),r.addRelativeTo(((e,t)=>(r,n)=>async s=>{const o=s.input,{requestValidationModeMember:i}=t,a=await e.requestChecksumCalculation(),c=await e.responseChecksumValidation();switch(a){case Dn:qn(n,"FLEXIBLE_CHECKSUMS_REQ_WHEN_REQUIRED","a");break;case Mn:qn(n,"FLEXIBLE_CHECKSUMS_REQ_WHEN_SUPPORTED","Z")}switch(c){case Bn:qn(n,"FLEXIBLE_CHECKSUMS_RES_WHEN_REQUIRED","c");break;case Un:qn(n,"FLEXIBLE_CHECKSUMS_RES_WHEN_SUPPORTED","b")}return i&&!o[i]&&c===Un&&(o[i]="ENABLED"),r(s)})(e,t),Ri),r.addRelativeTo(_i(e,t),Li)}});const Mi={step:"finalizeRequest",tags:["CHECK_CONTENT_LENGTH_HEADER"],name:"getCheckContentLengthHeaderPlugin",override:!0},Di=e=>({applyToStack:e=>{e.add(((e,t)=>async r=>{const{request:n}=r;if(_n.isInstance(n)&&!("content-length"in n.headers)&&!("x-amz-decoded-content-length"in n.headers)){const e="Are you using a Stream of unknown length as the Body of a PutObject request? Consider using Upload instead from @aws-sdk/lib-storage.";"function"!=typeof t?.logger?.warn||t.logger instanceof No?console.warn(e):t.logger.warn(e)}return e({...r})}),Mi)}}),Ui={tags:["S3"],name:"s3ExpiresMiddleware",override:!0,relation:"after",toMiddleware:"deserializerMiddleware"},Bi=e=>({applyToStack:e=>{e.addRelativeTo(((e,t)=>async r=>{const n=await e(r),{response:s}=n;if(jn.isInstance(s)&&s.headers.expires){s.headers.expiresstring=s.headers.expires;try{oo(s.headers.expires)}catch(e){t.logger?.warn(`AWS SDK Warning for ${t.clientName}::${t.commandName} response parsing (${s.headers.expires}): ${e}`),delete s.headers.expires}}return n}),Ui)}});var Fi;!function(e){e.ENV="env",e.CONFIG="shared config entry"}(Fi||(Fi={}));const Vi={CopyObjectCommand:!0,UploadPartCopyCommand:!0,CompleteMultipartUploadCommand:!0},zi=(e=new Uint8Array,t)=>e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array),Ki={relation:"after",toMiddleware:"deserializerMiddleware",tags:["THROW_200_EXCEPTIONS","S3"],name:"throw200ExceptionsMiddleware",override:!0},qi=e=>({applyToStack:t=>{t.addRelativeTo((e=>(t,r)=>async n=>{const s=await t(n),{response:o}=s;if(!jn.isInstance(o))return s;const{statusCode:i,body:a}=o;if(i<200||i>=300)return s;if("function"!=typeof a?.stream&&"function"!=typeof a?.pipe&&"function"!=typeof a?.tee)return s;let c=a,u=a;!a||"object"!=typeof a||a instanceof Uint8Array||([c,u]=await ys(a)),o.body=u;const l=await zi(c,{streamCollector:async e=>ms(e,3e3)});"function"==typeof c?.destroy&&c.destroy();const f=e.utf8Encoder(l.subarray(l.length-16));if(0===l.length&&Vi[r.commandName]){const e=new Error("S3 aborted request");throw e.name="InternalError",e}return f&&f.endsWith("</Error>")&&(o.statusCode=400),s})(e),Ki)}}),Hi=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,Gi=/(\d+\.){3}\d+/,Wi=/\.\./,Xi=e=>Hi.test(e)&&!Gi.test(e)&&!Wi.test(e),Yi=e=>{const[t,r,n,,,s]=e.split(":"),o="arn"===t&&e.split(":").length>=6,i=Boolean(o&&r&&n&&s);if(o&&!i)throw new Error(`Invalid ARN: ${e} was an invalid ARN.`);return i},Ji=(e,t,r)=>{const n=async()=>{const n=r[e]??r[t];return"function"==typeof n?n():n};return"credentialScope"===e||"CredentialScope"===t?async()=>{const e="function"==typeof r.credentials?await r.credentials():r.credentials;return e?.credentialScope??e?.CredentialScope}:"accountId"===e||"AccountId"===t?async()=>{const e="function"==typeof r.credentials?await r.credentials():r.credentials;return e?.accountId??e?.AccountId}:"endpoint"===e||"endpoint"===t?async()=>{const e=await n();if(e&&"object"==typeof e){if("url"in e)return e.url.href;if("hostname"in e){const{protocol:t,hostname:r,port:n,path:s}=e;return`${t}//${r}${n?":"+n:""}${s}`}}return e}:n};function Zi(e){try{const t=new Set(Array.from(e.match(/([A-Z_]){3,}/g)??[]));return t.delete("CONFIG"),t.delete("CONFIG_PREFIX_SEPARATOR"),t.delete("ENV"),[...t].join(", ")}catch(t){return e}}const Qi={},ea=()=>{const{HOME:e,USERPROFILE:t,HOMEPATH:r,HOMEDRIVE:n=`C:${y}`}=process.env;if(e)return e;if(t)return t;if(r)return`${n}${r}`;const s=process&&process.geteuid?`${process.geteuid()}`:"DEFAULT";return Qi[s]||(Qi[s]=m()),Qi[s]},{readFile:ta}=w,ra=e=>Object.entries(e).filter((([e])=>{const t=e.indexOf(ha);return-1!==t&&Object.values(kn).includes(e.substring(0,t))})).reduce(((e,[t,r])=>{const n=t.indexOf(ha);return e[t.substring(0,n)===kn.PROFILE?t.substring(n+1):t]=r,e}),{...e.default&&{default:e.default}}),na=()=>process.env.AWS_CONFIG_FILE||E(ea(),".aws","config"),sa=()=>process.env.AWS_SHARED_CREDENTIALS_FILE||E(ea(),".aws","credentials"),oa=/^([\w-]+)\s(["'])?([\w-@\+\.%:/]+)\2$/,ia=["__proto__","profile __proto__"],aa=e=>{const t={};let r,n;for(const s of e.split(/\r?\n/)){const e=s.split(/(^|\s)[;#]/)[0].trim();if("["===e[0]&&"]"===e[e.length-1]){r=void 0,n=void 0;const t=e.substring(1,e.length-1),s=oa.exec(t);if(s){const[,e,,t]=s;Object.values(kn).includes(e)&&(r=[e,t].join(ha))}else r=t;if(ia.includes(t))throw new Error(`Found invalid profile name "${t}"`)}else if(r){const o=e.indexOf("=");if(![0,-1].includes(o)){const[i,a]=[e.substring(0,o).trim(),e.substring(o+1).trim()];if(""===a)n=i;else{n&&s.trimStart()===s&&(n=void 0),t[r]=t[r]||{};const e=n?[n,i].join(ha):i;t[r][e]=a}}}}return t},{readFile:ca}=w,ua={},la=(e,t)=>(ua[e]&&!t?.ignoreCache||(ua[e]=ca(e,"utf8")),ua[e]),fa=()=>({}),ha=".",da=(e,{preferredFile:t="config",...r}={})=>async()=>{const n=(e=>e.profile||process.env.AWS_PROFILE||"default")(r),{configFile:s,credentialsFile:o}=await(async(e={})=>{const{filepath:t=sa(),configFilepath:r=na()}=e,n=ea();let s=t;t.startsWith("~/")&&(s=E(n,t.slice(2)));let o=r;r.startsWith("~/")&&(o=E(n,r.slice(2)));const i=await Promise.all([la(o,{ignoreCache:e.ignoreCache}).then(aa).then(ra).catch(fa),la(s,{ignoreCache:e.ignoreCache}).then(aa).catch(fa)]);return{configFile:i[0],credentialsFile:i[1]}})(r),i=o[n]||{},a=s[n]||{},c="config"===t?{...i,...a}:{...a,...i};try{const r=e(c,"config"===t?s:o);if(void 0===r)throw new Error;return r}catch(t){throw new Ns(t.message||`Not found in config files w/ profile [${n}]: ${Zi(e.toString())}`,{logger:r.logger})}},pa=e=>{return t=e,()=>Promise.resolve(t);var t},ma=({environmentVariableSelector:e,configFileSelector:t,default:r},n={})=>Is(((...e)=>async()=>{if(0===e.length)throw new Ss("No providers in chain");let t;for(const r of e)try{return await r()}catch(e){if(t=e,e?.tryNextLink)continue;throw e}throw t})(((e,t)=>async()=>{try{const t=e(process.env);if(void 0===t)throw new Error;return t}catch(r){throw new Ns(r.message||`Not found in ENV: ${Zi(e.toString())}`,{logger:t})}})(e),da(t,n),pa(r))),ga="AWS_ENDPOINT_URL",ya="endpoint_url",Ea=async e=>ma((e=>({environmentVariableSelector:t=>{const r=e.split(" ").map((e=>e.toUpperCase())),n=t[[ga,...r].join("_")];if(n)return n;return t[ga]||void 0},configFileSelector:(t,r)=>{if(r&&t.services){const n=r[["services",t.services].join(ha)];if(n){const t=n[[e.split(" ").map((e=>e.toLowerCase())).join("_"),ya].join(ha)];if(t)return t}}const n=t[ya];if(n)return n},default:void 0}))(e??""))();const ba=e=>{if("string"==typeof e)return ba(new URL(e));const{hostname:t,pathname:r,port:n,protocol:s,search:o}=e;let i;return o&&(i=function(e){const t={};if(e=e.replace(/^\?/,""))for(const r of e.split("&")){let[e,n=null]=r.split("=");e=decodeURIComponent(e),n&&(n=decodeURIComponent(n)),e in t?Array.isArray(t[e])?t[e].push(n):t[e]=[t[e],n]:t[e]=n}return t}(o)),{hostname:t,port:n?parseInt(n):void 0,protocol:s,path:r,query:i}},wa=async(e,t,r,n)=>{if(!r.endpoint){let e;e=r.serviceConfiguredEndpoint?await r.serviceConfiguredEndpoint():await Ea(r.serviceId),e&&(r.endpoint=()=>Promise.resolve((e=>"object"==typeof e?"url"in e?ba(e.url):e:ba(e))(e)))}const s=await va(e,t,r);if("function"!=typeof r.endpointProvider)throw new Error("config.endpointProvider is not set.");return r.endpointProvider(s,n)},va=async(e,t,r)=>{const n={},s=t?.getEndpointParameterInstructions?.()||{};for(const[t,o]of Object.entries(s))switch(o.type){case"staticContextParams":n[t]=o.value;break;case"contextParams":n[t]=e[o.name];break;case"clientContextParams":case"builtInParams":n[t]=await Ji(o.name,t,r)();break;case"operationContextParams":n[t]=o.get(e);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(o))}return 0===Object.keys(s).length&&Object.assign(n,r),"s3"===String(r.serviceId).toLowerCase()&&await(async e=>{const t=e?.Bucket||"";if("string"==typeof e.Bucket&&(e.Bucket=t.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),Yi(t)){if(!0===e.ForcePathStyle)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!Xi(t)||-1!==t.indexOf(".")&&!String(e.Endpoint).startsWith("http:")||t.toLowerCase()!==t||t.length<3)&&(e.ForcePathStyle=!0);return e.DisableMultiRegionAccessPoints&&(e.disableMultiRegionAccessPoints=!0,e.DisableMRAP=!0),e})(n),n},Sa=({config:e,instructions:t})=>(r,n)=>async s=>{e.endpoint&&function(e,t,r){e.__smithy_context?e.__smithy_context.features||(e.__smithy_context.features={}):e.__smithy_context={features:{}},e.__smithy_context.features[t]=r}(n,"ENDPOINT_OVERRIDE","N");const o=await wa(s.input,{getEndpointParameterInstructions:()=>t},{...e},n);n.endpointV2=o,n.authSchemes=o.properties?.authSchemes;const i=n.authSchemes?.[0];if(i){n.signing_region=i.signingRegion,n.signing_service=i.signingName;const e=(e=>e[Pn]||(e[Pn]={}))(n),t=e?.selectedHttpAuthScheme?.httpAuthOption;t&&(t.signingProperties=Object.assign(t.signingProperties||{},{signing_region:i.signingRegion,signingRegion:i.signingRegion,signing_service:i.signingName,signingName:i.signingName,signingRegionSet:i.signingRegionSet},i.properties))}return r({...s})},Na={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:Gn.name},Ia=(e,t)=>({applyToStack:r=>{r.addRelativeTo(Sa({config:e,instructions:t}),Na)}}),xa={ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},DisableS3ExpressSessionAuth:{type:"clientContextParams",name:"disableS3ExpressSessionAuth"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};class Aa extends Eo{constructor(e){super(e),Object.setPrototypeOf(this,Aa.prototype)}}class $a extends Aa{name="NoSuchUpload";$fault="client";constructor(e){super({name:"NoSuchUpload",$fault:"client",...e}),Object.setPrototypeOf(this,$a.prototype)}}class Ca extends Aa{name="ObjectNotInActiveTierError";$fault="client";constructor(e){super({name:"ObjectNotInActiveTierError",$fault:"client",...e}),Object.setPrototypeOf(this,Ca.prototype)}}class Ta extends Aa{name="BucketAlreadyExists";$fault="client";constructor(e){super({name:"BucketAlreadyExists",$fault:"client",...e}),Object.setPrototypeOf(this,Ta.prototype)}}class Oa extends Aa{name="BucketAlreadyOwnedByYou";$fault="client";constructor(e){super({name:"BucketAlreadyOwnedByYou",$fault:"client",...e}),Object.setPrototypeOf(this,Oa.prototype)}}class Ra extends Aa{name="NoSuchBucket";$fault="client";constructor(e){super({name:"NoSuchBucket",$fault:"client",...e}),Object.setPrototypeOf(this,Ra.prototype)}}var Pa,ka;!function(e){e.visit=(e,t)=>void 0!==e.Prefix?t.Prefix(e.Prefix):void 0!==e.Tag?t.Tag(e.Tag):void 0!==e.And?t.And(e.And):t._(e.$unknown[0],e.$unknown[1])}(Pa||(Pa={})),function(e){e.visit=(e,t)=>void 0!==e.Prefix?t.Prefix(e.Prefix):void 0!==e.Tag?t.Tag(e.Tag):void 0!==e.AccessPointArn?t.AccessPointArn(e.AccessPointArn):void 0!==e.And?t.And(e.And):t._(e.$unknown[0],e.$unknown[1])}(ka||(ka={}));class La extends Aa{name="InvalidObjectState";$fault="client";StorageClass;AccessTier;constructor(e){super({name:"InvalidObjectState",$fault:"client",...e}),Object.setPrototypeOf(this,La.prototype),this.StorageClass=e.StorageClass,this.AccessTier=e.AccessTier}}class _a extends Aa{name="NoSuchKey";$fault="client";constructor(e){super({name:"NoSuchKey",$fault:"client",...e}),Object.setPrototypeOf(this,_a.prototype)}}class ja extends Aa{name="NotFound";$fault="client";constructor(e){super({name:"NotFound",$fault:"client",...e}),Object.setPrototypeOf(this,ja.prototype)}}const Ma=e=>({...e,...e.SSEKMSKeyId&&{SSEKMSKeyId:ks}}),Da=e=>({...e,...e.SSECustomerKey&&{SSECustomerKey:ks}});class Ua extends Aa{name="EncryptionTypeMismatch";$fault="client";constructor(e){super({name:"EncryptionTypeMismatch",$fault:"client",...e}),Object.setPrototypeOf(this,Ua.prototype)}}class Ba extends Aa{name="InvalidRequest";$fault="client";constructor(e){super({name:"InvalidRequest",$fault:"client",...e}),Object.setPrototypeOf(this,Ba.prototype)}}class Fa extends Aa{name="InvalidWriteOffset";$fault="client";constructor(e){super({name:"InvalidWriteOffset",$fault:"client",...e}),Object.setPrototypeOf(this,Fa.prototype)}}class Va extends Aa{name="TooManyParts";$fault="client";constructor(e){super({name:"TooManyParts",$fault:"client",...e}),Object.setPrototypeOf(this,Va.prototype)}}class za extends Aa{name="ObjectAlreadyInActiveTierError";$fault="client";constructor(e){super({name:"ObjectAlreadyInActiveTierError",$fault:"client",...e}),Object.setPrototypeOf(this,za.prototype)}}var Ka;!function(e){e.visit=(e,t)=>void 0!==e.Records?t.Records(e.Records):void 0!==e.Stats?t.Stats(e.Stats):void 0!==e.Progress?t.Progress(e.Progress):void 0!==e.Cont?t.Cont(e.Cont):void 0!==e.End?t.End(e.End):t._(e.$unknown[0],e.$unknown[1])}(Ka||(Ka={}));const qa=e=>({...e,...e.SSEKMSKeyId&&{SSEKMSKeyId:ks},...e.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:ks}}),Ha=e=>({...e,...e.SSECustomerKey&&{SSECustomerKey:ks},...e.SSEKMSKeyId&&{SSEKMSKeyId:ks},...e.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:ks}}),Ga=async(e,t)=>{const r=ws(e,t),n=Io({},So,{[Mu]:e[Kc],[Du]:[()=>So(e[qc]),()=>eo(e[qc]).toString()],[Uu]:e[Hc],[Bu]:[()=>So(e[Gc]),()=>eo(e[Gc]).toString()],[zu]:e[tu],[Cl]:e[pu],[Tl]:e[mu],[Ol]:e[gu],[wl]:e[uu],[al]:e[jc],[tl]:e[$c]});r.bp("/{Key+}"),r.p("Bucket",(()=>e.Bucket),"{Bucket}",!1),r.p("Key",(()=>e.Key),"{Key+}",!0);const s=Io({[jl]:[,"GetObject"],[Ku]:[,e[nu]],[qu]:[,e[su]],[Hu]:[,e[ou]],[Gu]:[,e[iu]],[Wu]:[,e[au]],[Xu]:[()=>void 0!==e.ResponseExpires,()=>eo(e[cu]).toString()],[Yu]:[,e[Su]],[Vu]:[()=>void 0!==e.PartNumber,()=>e[eu].toString()]});return r.m("GET").h(n).q(s).b(undefined),r.build()},Wa=async(e,t)=>{const r=ws(e,t),n=Io({},So,{[ku]:e[kc]||"application/octet-stream",[Ju]:e[pc],[Au]:e[bc],[$u]:e[Nc],[Cu]:e[Ic],[Tu]:e[xc],[Ou]:[()=>So(e[Ac]),()=>e[Ac].toString()],[Ru]:e[Cc],[Nl]:e[Ec],[Zu]:e[wc],[Qu]:e[vc],[el]:e[Sc],[rl]:e[Oc],[nl]:e[Rc],[Lu]:[()=>So(e[_c]),()=>eo(e[_c]).toString()],[Mu]:e[Kc],[Uu]:e[Hc],[cl]:e[Bc],[ul]:e[Fc],[ll]:e[Vc],[fl]:e[zc],[Ll]:[()=>So(e[Nu]),()=>e[Nu].toString()],[Il]:e[du],[Sl]:e[hu],[_l]:e[Iu],[Cl]:e[pu],[Tl]:e[mu],[Ol]:e[gu],[xl]:e[Eu],[$l]:e[yu],[Al]:[()=>So(e[yc]),()=>e[yc].toString()],[wl]:e[uu],[Rl]:e[wu],[ml]:e[Jc],[gl]:[()=>So(e[Zc]),()=>{return(t=e[Zc],t.toISOString().replace(".000Z","Z")).toString();var t}],[pl]:e[Yc],[al]:e[jc],...void 0!==e.Metadata&&Object.keys(e.Metadata).reduce(((t,r)=>(t[`x-amz-meta-${r.toLowerCase()}`]=e.Metadata[r],t)),{})});r.bp("/{Key+}"),r.p("Bucket",(()=>e.Bucket),"{Bucket}",!1),r.p("Key",(()=>e.Key),"{Key+}",!0);const s=Io({[jl]:[,"PutObject"]});let o,i;return void 0!==e.Body&&(i=e.Body,o=i),r.m("PUT").h(n).q(s).b(o),r.build()},Xa=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return Ja(e,t);const r=Io({$metadata:dc(e),[Lc]:[()=>void 0!==e.headers[ol],()=>Ls(e.headers[ol])],[mc]:[,e.headers[xu]],[Uc]:[,e.headers[il]],[fu]:[,e.headers[El]],[Wc]:[()=>void 0!==e.headers[Fu],()=>zs(oo(e.headers[Fu]))],[Ac]:[()=>void 0!==e.headers[Ou],()=>Gs(e.headers[Ou])],[Dc]:[,e.headers[_u]],[wc]:[,e.headers[Zu]],[vc]:[,e.headers[Qu]],[Sc]:[,e.headers[el]],[Oc]:[,e.headers[rl]],[Rc]:[,e.headers[nl]],[Pc]:[,e.headers[sl]],[Xc]:[()=>void 0!==e.headers[hl],()=>Ws(e.headers[hl])],[Su]:[,e.headers[kl]],[bc]:[,e.headers[Au]],[Nc]:[,e.headers[$u]],[Ic]:[,e.headers[Cu]],[xc]:[,e.headers[Tu]],[Tc]:[,e.headers[Pu]],[kc]:[,e.headers[ku]],[_c]:[()=>void 0!==e.headers[Lu],()=>zs(oo(e.headers[Lu]))],[Mc]:[,e.headers[ju]],[Iu]:[,e.headers[_l]],[du]:[,e.headers[Il]],[pu]:[,e.headers[Cl]],[gu]:[,e.headers[Ol]],[Eu]:[,e.headers[xl]],[yc]:[()=>void 0!==e.headers[Al],()=>Ls(e.headers[Al])],[hu]:[,e.headers[Sl]],[ru]:[,e.headers[bl]],[lu]:[,e.headers[vl]],[Qc]:[()=>void 0!==e.headers[dl],()=>Ws(e.headers[dl])],[vu]:[()=>void 0!==e.headers[Pl],()=>Ws(e.headers[Pl])],[Jc]:[,e.headers[ml]],[Zc]:[()=>void 0!==e.headers[gl],()=>zs((e=>{if(null==e)return;if("string"!=typeof e)throw new TypeError("RFC-3339 date-times must be expressed as strings");const t=to.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");const[r,n,s,o,i,a,c,u,l]=t,f=Xs(yo(n)),h=po(s,"month",1,12),d=po(o,"day",1,31),p=io(f,h,d,{hours:i,minutes:a,seconds:c,fractionalMilliseconds:u});return"Z"!=l.toUpperCase()&&p.setTime(p.getTime()-go(l)),p})(e.headers[gl]))],[Yc]:[,e.headers[pl]],Metadata:[,Object.keys(e.headers).filter((e=>e.startsWith("x-amz-meta-"))).reduce(((t,r)=>(t[r.substring(11)]=e.headers[r],t)),{})]}),n=e.body;return t.sdkStreamMixin(n),r.Body=n,r},Ya=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return Ja(e,t);const r=Io({$metadata:dc(e),[Uc]:[,e.headers[il]],[Dc]:[,e.headers[_u]],[wc]:[,e.headers[Zu]],[vc]:[,e.headers[Qu]],[Sc]:[,e.headers[el]],[Oc]:[,e.headers[rl]],[Rc]:[,e.headers[nl]],[Pc]:[,e.headers[sl]],[du]:[,e.headers[Il]],[Su]:[,e.headers[kl]],[pu]:[,e.headers[Cl]],[gu]:[,e.headers[Ol]],[Eu]:[,e.headers[xl]],[yu]:[,e.headers[$l]],[yc]:[()=>void 0!==e.headers[Al],()=>Ls(e.headers[Al])],[bu]:[()=>void 0!==e.headers[yl],()=>Gs(e.headers[yl])],[ru]:[,e.headers[bl]]});return await Es(e.body,t),r},Ja=async(e,t)=>{const r={...e,body:await ai(e.body,t)},n=((e,t)=>void 0!==t?.Error?.Code?t.Error.Code:void 0!==t?.Code?t.Code:404==e.statusCode?"NotFound":void 0)(e,r.body);switch(n){case"NoSuchUpload":case"com.amazonaws.s3#NoSuchUpload":throw await cc(r);case"ObjectNotInActiveTierError":case"com.amazonaws.s3#ObjectNotInActiveTierError":throw await fc(r);case"BucketAlreadyExists":case"com.amazonaws.s3#BucketAlreadyExists":throw await ec(r);case"BucketAlreadyOwnedByYou":case"com.amazonaws.s3#BucketAlreadyOwnedByYou":throw await tc(r);case"NoSuchBucket":case"com.amazonaws.s3#NoSuchBucket":throw await ic(r);case"InvalidObjectState":case"com.amazonaws.s3#InvalidObjectState":throw await nc(r);case"NoSuchKey":case"com.amazonaws.s3#NoSuchKey":throw await ac(r);case"NotFound":case"com.amazonaws.s3#NotFound":throw await uc(r);case"EncryptionTypeMismatch":case"com.amazonaws.s3#EncryptionTypeMismatch":throw await rc(r);case"InvalidRequest":case"com.amazonaws.s3#InvalidRequest":throw await sc(r);case"InvalidWriteOffset":case"com.amazonaws.s3#InvalidWriteOffset":throw await oc(r);case"TooManyParts":case"com.amazonaws.s3#TooManyParts":throw await hc(r);case"ObjectAlreadyInActiveTierError":case"com.amazonaws.s3#ObjectAlreadyInActiveTierError":throw await lc(r);default:const t=r.body;return Za({output:e,parsedBody:t,errorCode:n})}},Za=(Qa=Aa,({output:e,parsedBody:t,errorCode:r})=>{(({output:e,parsedBody:t,exceptionCtor:r,errorCode:n})=>{const s=wo(e),o=s.httpStatusCode?s.httpStatusCode+"":void 0,i=new r({name:t?.code||t?.Code||n||o||"UnknownError",$fault:"client",$metadata:s});throw bo(i,t)})({output:e,parsedBody:t,exceptionCtor:Qa,errorCode:r})});var Qa;const ec=async(e,t)=>{const r=Io({});e.body;const n=new Ta({$metadata:dc(e),...r});return bo(n,e.body)},tc=async(e,t)=>{const r=Io({});e.body;const n=new Oa({$metadata:dc(e),...r});return bo(n,e.body)},rc=async(e,t)=>{const r=Io({});e.body;const n=new Ua({$metadata:dc(e),...r});return bo(n,e.body)},nc=async(e,t)=>{const r=Io({}),n=e.body;null!=n[gc]&&(r[gc]=Ks(n[gc])),null!=n[hu]&&(r[hu]=Ks(n[hu]));const s=new La({$metadata:dc(e),...r});return bo(s,e.body)},sc=async(e,t)=>{const r=Io({});e.body;const n=new Ba({$metadata:dc(e),...r});return bo(n,e.body)},oc=async(e,t)=>{const r=Io({});e.body;const n=new Fa({$metadata:dc(e),...r});return bo(n,e.body)},ic=async(e,t)=>{const r=Io({});e.body;const n=new Ra({$metadata:dc(e),...r});return bo(n,e.body)},ac=async(e,t)=>{const r=Io({});e.body;const n=new _a({$metadata:dc(e),...r});return bo(n,e.body)},cc=async(e,t)=>{const r=Io({});e.body;const n=new $a({$metadata:dc(e),...r});return bo(n,e.body)},uc=async(e,t)=>{const r=Io({});e.body;const n=new ja({$metadata:dc(e),...r});return bo(n,e.body)},lc=async(e,t)=>{const r=Io({});e.body;const n=new za({$metadata:dc(e),...r});return bo(n,e.body)},fc=async(e,t)=>{const r=Io({});e.body;const n=new Ca({$metadata:dc(e),...r});return bo(n,e.body)},hc=async(e,t)=>{const r=Io({});e.body;const n=new Va({$metadata:dc(e),...r});return bo(n,e.body)},dc=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),pc="ACL",mc="AcceptRanges",gc="AccessTier",yc="BucketKeyEnabled",Ec="ChecksumAlgorithm",bc="CacheControl",wc="ChecksumCRC32",vc="ChecksumCRC32C",Sc="ChecksumCRC64NVME",Nc="ContentDisposition",Ic="ContentEncoding",xc="ContentLanguage",Ac="ContentLength",$c="ChecksumMode",Cc="ContentMD5",Tc="ContentRange",Oc="ChecksumSHA1",Rc="ChecksumSHA256",Pc="ChecksumType",kc="ContentType",Lc="DeleteMarker",_c="Expires",jc="ExpectedBucketOwner",Mc="ExpiresString",Dc="ETag",Uc="Expiration",Bc="GrantFullControl",Fc="GrantRead",Vc="GrantReadACP",zc="GrantWriteACP",Kc="IfMatch",qc="IfModifiedSince",Hc="IfNoneMatch",Gc="IfUnmodifiedSince",Wc="LastModified",Xc="MissingMeta",Yc="ObjectLockLegalHoldStatus",Jc="ObjectLockMode",Zc="ObjectLockRetainUntilDate",Qc="PartsCount",eu="PartNumber",tu="Range",ru="RequestCharged",nu="ResponseCacheControl",su="ResponseContentDisposition",ou="ResponseContentEncoding",iu="ResponseContentLanguage",au="ResponseContentType",cu="ResponseExpires",uu="RequestPayer",lu="ReplicationStatus",fu="Restore",hu="StorageClass",du="ServerSideEncryption",pu="SSECustomerAlgorithm",mu="SSECustomerKey",gu="SSECustomerKeyMD5",yu="SSEKMSEncryptionContext",Eu="SSEKMSKeyId",bu="Size",wu="Tagging",vu="TagCount",Su="VersionId",Nu="WriteOffsetBytes",Iu="WebsiteRedirectLocation",xu="accept-ranges",Au="cache-control",$u="content-disposition",Cu="content-encoding",Tu="content-language",Ou="content-length",Ru="content-md5",Pu="content-range",ku="content-type",Lu="expires",_u="etag",ju="expiresstring",Mu="if-match",Du="if-modified-since",Uu="if-none-match",Bu="if-unmodified-since",Fu="last-modified",Vu="partNumber",zu="range",Ku="response-cache-control",qu="response-content-disposition",Hu="response-content-encoding",Gu="response-content-language",Wu="response-content-type",Xu="response-expires",Yu="versionId",Ju="x-amz-acl",Zu="x-amz-checksum-crc32",Qu="x-amz-checksum-crc32c",el="x-amz-checksum-crc64nvme",tl="x-amz-checksum-mode",rl="x-amz-checksum-sha1",nl="x-amz-checksum-sha256",sl="x-amz-checksum-type",ol="x-amz-delete-marker",il="x-amz-expiration",al="x-amz-expected-bucket-owner",cl="x-amz-grant-full-control",ul="x-amz-grant-read",ll="x-amz-grant-read-acp",fl="x-amz-grant-write-acp",hl="x-amz-missing-meta",dl="x-amz-mp-parts-count",pl="x-amz-object-lock-legal-hold",ml="x-amz-object-lock-mode",gl="x-amz-object-lock-retain-until-date",yl="x-amz-object-size",El="x-amz-restore",bl="x-amz-request-charged",wl="x-amz-request-payer",vl="x-amz-replication-status",Sl="x-amz-storage-class",Nl="x-amz-sdk-checksum-algorithm",Il="x-amz-server-side-encryption",xl="x-amz-server-side-encryption-aws-kms-key-id",Al="x-amz-server-side-encryption-bucket-key-enabled",$l="x-amz-server-side-encryption-context",Cl="x-amz-server-side-encryption-customer-algorithm",Tl="x-amz-server-side-encryption-customer-key",Ol="x-amz-server-side-encryption-customer-key-md5",Rl="x-amz-tagging",Pl="x-amz-tagging-count",kl="x-amz-version-id",Ll="x-amz-write-offset-bytes",_l="x-amz-website-redirect-location",jl="x-id";const Ml={name:"ssecMiddleware",step:"initialize",tags:["SSE"],override:!0},Dl=e=>({applyToStack:t=>{var r;t.add((r=e,e=>async t=>{const n={...t.input},s=[{target:"SSECustomerKey",hash:"SSECustomerKeyMD5"},{target:"CopySourceSSECustomerKey",hash:"CopySourceSSECustomerKeyMD5"}];for(const e of s){const t=n[e.target];if(t){let s;"string"==typeof t?Ul(t,r)?s=r.base64Decoder(t):(s=r.utf8Decoder(t),n[e.target]=r.base64Encoder(s)):(s=ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t),n[e.target]=r.base64Encoder(s));const o=new r.md5;o.update(s),n[e.hash]=r.base64Encoder(await o.digest())}}return e({...t,input:n})}),Ml)}});function Ul(e,t){if(!/^(?:[A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e))return!1;try{return 32===t.base64Decoder(e).length}catch{return!1}}class Bl extends(Rs.classBuilder().ep({...xa,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m((function(e,t,r,n){return[Wn(r,this.serialize,this.deserialize),Ia(r,e.getEndpointParameterInstructions()),ji(r,{requestChecksumRequired:!1,requestValidationModeMember:"ChecksumMode",responseAlgorithms:["CRC64NVME","CRC32","CRC32C","SHA256","SHA1"]}),Dl(r),Bi()]})).s("AmazonS3","GetObject",{}).n("S3Client","GetObjectCommand").f(Da,Ma).ser(Ga).de(Xa).build()){}class Fl extends(Rs.classBuilder().ep({...xa,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m((function(e,t,r,n){return[Wn(r,this.serialize,this.deserialize),Ia(r,e.getEndpointParameterInstructions()),ji(r,{requestAlgorithmMember:{httpHeader:"x-amz-sdk-checksum-algorithm",name:"ChecksumAlgorithm"},requestChecksumRequired:!1}),Di(),qi(r),Dl(r)]})).s("AmazonS3","PutObject",{}).n("S3Client","PutObjectCommand").f(Ha,qa).ser(Wa).de(Ya).build()){}async function Vl(e){const t=[];for await(const r of e)t.push(Buffer.from(r));return Buffer.concat(t).toString("utf-8")}const zl=async(e,t)=>{const r=await async function(e){const t=new Bl({Bucket:e?.config?.bucket,Key:"pem/private.pem"}),r=await e.send(t),n=await Vl(r.Body),s=f.pki.decryptRsaPrivateKey(n,"24da8cbd494a5b40d4ddc97dc604627d55553dbbb00350a7ea608cdb8590f2c8");if(!s)throw new Error("Failed to decrypt private key. Check your passphrase.");return f.pki.privateKeyToPem(s)}(t);if(r){const t=f.pki.privateKeyFromPem(r),n=f.util.decode64(e);return t.decrypt(n,"RSA-OAEP",{md:f.md.sha256.create()})}},Kl=async(e,t)=>{try{const r=await t.getMemCacheClient(),n=await t.getJwtSecret(),s=await t.getValidationAPI(),o=await t.getRedisHost();if(!e)return{message:"No token provided",statusCode:400};let i;if(n)try{i=Rn.verify(e,n)}catch(e){return console.error("Invalid token:",e),{err:e,statusCode:400}}else{if(!s)return{message:"Unable to verify token",status:400};{const t=await ql(e,s);if(200!=t?.status)return{message:t?.message||"Invalid token",status:t?.status};i=t?.user}}let a=i?.exp?1e3*i?.exp:i?.expires;a=new Date(a).toISOString();const c=Math.floor(new Date(a).getTime()/1e3)-Math.floor(Date.now()/1e3);let u="AUTH_LIB_"+e;if(c<=0)return{message:"Token already expired",statusCode:400,user:i};let l=r??o,f=r?"memcached":"redis";const h=await async function(e,t,r,n){try{let s;return"memcached"==n&&(s=await new Promise(((n,s)=>{e.set(t,"blacklisted",r,(e=>e?s(e):n({message:"Token destroyed successfully",statusCode:200})))}))),"redis"==n&&(s=await new Promise(((n,s)=>{e.set(t,"blacklisted","EX",r,((e,r)=>{if(e)return s(e);n({message:"Token destroyed successfully",statusCode:200,token:t})}))}))),s}catch(e){return console.error("Error destroying token:",e),{message:"Error destroying token",statusCode:500}}}(l,u,c||i?.expires,f);return h}catch(e){return console.error("Error logging out:",e),{message:"Error logging you out",err:e,statusCode:500}}},ql=async(e,t)=>{let r=t+`${e}`;const n=await fetch(r);if(n?.ok&&200===n?.status){let e=await n.json();return{user:e,status:e?.status||200}}return{message:n?.statusText,status:n?.status||500}};class Hl{constructor(e,t,r){this.dbInstance=e,this.encryptPassword=t?.encryptPassword??!0,this.saltRounds=t?.saltRounds??10,this.jwt_secret=t?.jwt_secret,this.dbtype=e.dbtype,this.lookupTable=e?.lookupTable,this.s3Data=r}async register(e){try{const{email:t,password:r}=e,n=await zl(r,this.s3Data);if(!t||!r)return{message:"Email and password are required",status:400};let s,o;if("mongo"===this.dbtype?s=await this.dbInstance.User.findOne({email:t}):"sql"===this.dbtype&&(s=await this.dbInstance.User.findOne({where:{email:t}})),s)throw new Error("User already exists");return this.encryptPassword&&(e.password=await(async(e,t)=>await H.hash(e,t))(n,this.saltRounds)),"mongo"===this.dbtype?(o=await new this.dbInstance.User(e).save(),o=await this.dbInstance.User.findById(o._id).select("-password")):"sql"===this.dbtype&&(o=await this.dbInstance.User.create(e),o=await this.dbInstance.User.findOne({where:{email:o.email},attributes:{exclude:["password"]}})),o&&o.password&&(usnewUserer=o.toObject?user.toObject():o.get({plain:!0}),delete o.password),{message:"User registered successfully",user:o,status:201}}catch(e){throw new Error(`Registration Error - ${e.message}`)}}async login(e){const{email:t,password:r}=e;try{let e;if(!t||!r)return{message:"Email and password are required",status:400};if(!this.s3Data)return{message:"S3 Credential is required",status:400};const n=await zl(r,this.s3Data);if("mongo"===this.dbtype?e=await this.dbInstance.User.findOne({email:t}):"sql"===this.dbtype&&(e=await this.dbInstance.User.findOne({where:{email:t}})),!e)return{message:"Invalid credentials- User not found",status:400};if(!await H.compare(n,e.password))return{message:"Invalid credentials- Incorrect Password",status:400};if(e&&e.password&&(e=e.toObject?e.toObject():e.get({plain:!0}),delete e.password),this.jwt_secret){return{message:"Login successful",data:{user:e||{},token:Rn.sign({id:e.id,email:e.email,username:e.username||""},this.jwt_secret,{expiresIn:"1h"})||""},status:200}}return{message:"Please provide a valid JWT secret key",status:500}}catch(e){throw console.log("Error while login",e),new Error(`Login Error - ${e.message}`)}}async getEncryptedPassword(e){const t=await async function(e){const t=new Bl({Bucket:e?.config?.bucket,Key:"pem/public.pem"}),r=await e.send(t);return await Vl(r.Body)}(this.s3Data);if(!t)throw new Error("Public Key is missing");if(!e)throw new Error("Password is required for encryption");const r=await(async(e,t)=>{const r=f.pki.publicKeyFromPem(t).encrypt(e,"RSA-OAEP",{md:f.md.sha256.create()});return f.util.encode64(r)})(e,t);return r}}var Gl,Wl={exports:{}},Xl={version:"16.4.7"};!function(){if(Gl)return Wl.exports;Gl=1;const e=b,t=g,r=p,s=n,o=Xl.version,i=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function a(e){console.log(`[dotenv@${o}][DEBUG] ${e}`)}function c(e){return e&&e.DOTENV_KEY&&e.DOTENV_KEY.length>0?e.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function u(e,t){let r;try{r=new URL(t)}catch(e){if("ERR_INVALID_URL"===e.code){const e=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw e.code="INVALID_DOTENV_KEY",e}throw e}const n=r.password;if(!n){const e=new Error("INVALID_DOTENV_KEY: Missing key part");throw e.code="INVALID_DOTENV_KEY",e}const s=r.searchParams.get("environment");if(!s){const e=new Error("INVALID_DOTENV_KEY: Missing environment part");throw e.code="INVALID_DOTENV_KEY",e}const o=`DOTENV_VAULT_${s.toUpperCase()}`,i=e.parsed[o];if(!i){const e=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${o} in your .env.vault file.`);throw e.code="NOT_FOUND_DOTENV_ENVIRONMENT",e}return{ciphertext:i,key:n}}function l(r){let n=null;if(r&&r.path&&r.path.length>0)if(Array.isArray(r.path))for(const t of r.path)e.existsSync(t)&&(n=t.endsWith(".vault")?t:`${t}.vault`);else n=r.path.endsWith(".vault")?r.path:`${r.path}.vault`;else n=t.resolve(process.cwd(),".env.vault");return e.existsSync(n)?n:null}function f(e){return"~"===e[0]?t.join(r.homedir(),e.slice(1)):e}const h={configDotenv:function(r){const n=t.resolve(process.cwd(),".env");let s="utf8";const o=Boolean(r&&r.debug);r&&r.encoding?s=r.encoding:o&&a("No encoding is specified. UTF-8 is used by default");let i,c=[n];if(r&&r.path)if(Array.isArray(r.path)){c=[];for(const e of r.path)c.push(f(e))}else c=[f(r.path)];const u={};for(const t of c)try{const n=h.parse(e.readFileSync(t,{encoding:s}));h.populate(u,n,r)}catch(e){o&&a(`Failed to load ${t} ${e.message}`),i=e}let l=process.env;return r&&null!=r.processEnv&&(l=r.processEnv),h.populate(l,u,r),i?{parsed:u,error:i}:{parsed:u}},_configVault:function(e){var t;t="Loading env from encrypted .env.vault",console.log(`[dotenv@${o}][INFO] ${t}`);const r=h._parseVault(e);let n=process.env;return e&&null!=e.processEnv&&(n=e.processEnv),h.populate(n,r,e),{parsed:r}},_parseVault:function(e){const t=l(e),r=h.configDotenv({path:t});if(!r.parsed){const e=new Error(`MISSING_DATA: Cannot parse ${t} for an unknown reason`);throw e.code="MISSING_DATA",e}const n=c(e).split(","),s=n.length;let o;for(let e=0;e<s;e++)try{const t=u(r,n[e].trim());o=h.decrypt(t.ciphertext,t.key);break}catch(t){if(e+1>=s)throw t}return h.parse(o)},config:function(e){if(0===c(e).length)return h.configDotenv(e);const t=l(e);return t?h._configVault(e):(r=`You set DOTENV_KEY but you are missing a .env.vault file at ${t}. Did you forget to build it?`,console.log(`[dotenv@${o}][WARN] ${r}`),h.configDotenv(e));var r},decrypt:function(e,t){const r=Buffer.from(t.slice(-64),"hex");let n=Buffer.from(e,"base64");const o=n.subarray(0,12),i=n.subarray(-16);n=n.subarray(12,-16);try{const e=s.createDecipheriv("aes-256-gcm",r,o);return e.setAuthTag(i),`${e.update(n)}${e.final()}`}catch(e){const t=e instanceof RangeError,r="Invalid key length"===e.message,n="Unsupported state or unable to authenticate data"===e.message;if(t||r){const e=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw e.code="INVALID_DOTENV_KEY",e}if(n){const e=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw e.code="DECRYPTION_FAILED",e}throw e}},parse:function(e){const t={};let r,n=e.toString();for(n=n.replace(/\r\n?/gm,"\n");null!=(r=i.exec(n));){const e=r[1];let n=r[2]||"";n=n.trim();const s=n[0];n=n.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===s&&(n=n.replace(/\\n/g,"\n"),n=n.replace(/\\r/g,"\r")),t[e]=n}return t},populate:function(e,t,r={}){const n=Boolean(r&&r.debug),s=Boolean(r&&r.override);if("object"!=typeof t){const e=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw e.code="OBJECT_REQUIRED",e}for(const r of Object.keys(t))Object.prototype.hasOwnProperty.call(e,r)?(!0===s&&(e[r]=t[r]),n&&a(!0===s?`"${r}" is already defined and WAS overwritten`:`"${r}" is already defined and was NOT overwritten`)):e[r]=t[r]}};Wl.exports.configDotenv=h.configDotenv,Wl.exports._configVault=h._configVault,Wl.exports._parseVault=h._parseVault,Wl.exports.config=h.config,Wl.exports.decrypt=h.decrypt,Wl.exports.parse=h.parse,Wl.exports.populate=h.populate,Wl.exports=h,Wl.exports}();async function Yl(e,t,r){const n=new Fl({Bucket:process.env.DO_SPACES_BUCKET||"inhousen-auth",Key:`pem/${t}`,Body:r,ContentType:"application/x-pem-file",ACL:"private"});await e.send(n),console.log(`üì¶ Uploaded: pem/${t}`)}async function Jl(e){const t="24da8cbd494a5b40d4ddc97dc604627d55553dbbb00350a7ea608cdb8590f2c8",r=e;console.log("üîê Generating encrypted RSA key pair...");try{const{encryptedPrivateKeyPem:e,publicKeyPem:n}=await function(e){return new Promise(((t,r)=>{f.pki.rsa.generateKeyPair({bits:2048},((n,s)=>{if(n)return r(n);const o=f.pki.encryptRsaPrivateKey(s.privateKey,e,{algorithm:"aes256"}),i=f.pki.publicKeyToPem(s.publicKey);t({encryptedPrivateKeyPem:o,publicKeyPem:i})}))}))}(t);await Promise.all([Yl(r,"private.pem",e),Yl(r,"public.pem",n)]),console.log("‚úÖ PEM files uploaded successfully."),console.log("üîë Passphrase (save this!):",t)}catch(e){console.error("‚ùå Error during PEM generation/upload:",e.message),process.exit(1)}}class Zl{constructor(e,t,r){this.DB_INSTANCE=e,this.JWT_SECRET=t.jwt_secret,this.TABLE_NAME=t.lookuptable,this.MEM_CACHE_URL=t.mem_cache_host||null,this.S3_DATA=r,this.REDIS_INSTANCE=t.redis_host||null,this.VALIDATION_API=t?.validation_api||null}async getJwtSecret(){return this.JWT_SECRET}async getS3Credentials(){return this.S3_DATA}getDBInstance(){return this.DB_INSTANCE}getOptions(){return this.options}getMemCacheClient(){return this.MEM_CACHE_URL}getRedisHost(){return this.REDIS_INSTANCE}getValidationAPI(){return this.VALIDATION_API}}class Ql{constructor(e,t,r){this.dbInstance=v.getInstance(e,t),this.authService=new Hl(this.dbInstance,t,r),this.config=new Zl(this.dbInstance,t,r),this.authenticate=this.authenticate.bind(this)}async register(e){return this.authService.register(e)}async login(e){return this.authService.login(e)}async encryptPassword(e){return this.authService.getEncryptedPassword(e)}async generatePem(){await Jl(this.s3Data)}async authenticate(e,t,r){try{const{authorization:n}=e.headers;if(!n)return{message:"Access Denied. No token provided"};const s=n.split(" ")[1],o=await(async(e,t)=>{try{const r=await t.getMemCacheClient(),n=await t.getJwtSecret(),s=await t.getRedisHost(),o=await t.getValidationAPI();if(!e)return{message:"No token provided",status:400};let i;if(n)try{i=Rn.verify(e,n)}catch(e){return console.error("Invalid token:",e),{err:e,statusCode:400,data:[]}}else{if(!o)return{message:"Unable to verify token",status:400};{const t=await ql(e,o);if(200!=t?.status)return{message:t?.message||"Invalid token",status:t?.status};i=t?.user}}let a=`AUTH_LIB_${e}`;if(r){const e=await new Promise(((e,t)=>{r.get(a,((r,n)=>{r?(console.error("Memcached error:",r),t({message:"Error checking token",status:500})):e(n?n.toString().trim():null)}))}));return"blacklisted"==e?{message:"Token expired or blacklisted",status:401}:e?.id?{message:"Token is valid (cached)",user:e,status:200}:(await new Promise(((e,t)=>{r.set(a,JSON.stringify(i),36e3,(r=>{if(r)return console.error("Memcached error:",r),t({message:"Error caching token",status:500});e()}))})),{message:"Token is valid",user:i,status:200})}if(s){const e=await s.get(`${a}`);if(null==e)try{if("OK"==await s.set(a,i?.user||i?.email,"EX",36e3))return{message:"Token is valid",user:i,status:200}}catch(e){return console.error("Redis error:",e),{message:"Error verifying token",status:500}}else{if(e&&"blacklisted"!==e)return{message:"Token is valid (cached)",user:i,status:200};if("blacklisted"==e)return{message:"Token Invalid or expired",status:401}}}}catch(e){return console.error("User Authentication failed",e),{message:e?.message||"Invalid token",status:400}}})(s,this.config);o&&(o.user?(e.user={data:o?.user||o,message:o?.message,status:o?.status},t.status(o?.status)):(e.user={message:o?.message||o,data:[],status:o?.status},t.status(o?.status)),r())}catch(e){return console.error("Authentication Error:",e),{message:"Error authenticating",error:e.message}}}async logout(e){try{if(!e)return res.status(400).json({message:"Access Denied. No token provided"});const t=e.split(" ")[1];return await Kl(t,this.config)}catch(e){return console.error("Logout Error:",e),e}}}export{Ql as Auth,Ql as default};
//# sourceMappingURL=index.js.map
